(()=>{"use strict";const t=class{constructor(t,e,s,i,n,r,o){this._name=t.name,this._link=t.link,this._userId=e._id,this._ownerId=t.owner._id,this._cardId=t._id,this._template=s,this._handleCardClick=i,this._deleteCard=n,this._likeCard=r,this._dislikeCard=o,this._likeQuantity=t.likes}getTemplateCard=()=>(this._card=document.querySelector(this._template).content.querySelector(".elements__element").cloneNode(!0),this._like=this._card.querySelector(".like__vector"),this._likeQuantityCard=this._card.querySelector(".like__quantity"),this._title=this._card.querySelector(".description__title"),this._image=this._card.querySelector(".element__image"),this._delete=this._card.querySelector(".element__del"),this._fillCard(),this._setEventHandlers(),this._card);likeElement(t){this._likeQuantityCard.textContent=t.likes.length,this._likeQuantity=t.likes,this._like.classList.add("like__vector_active")}dislikeElement(t){this._like.classList.remove("like__vector_active"),this._likeQuantityCard.textContent=t.likes.length,this._likeQuantity=t.likes}_isLike=()=>this._likeQuantity.find((t=>t._id===this._userId));_isYourCard(){return this._ownerId===this._userId}_likeCardForUser(){this._isLike()?this._dislikeCard(this,this._cardId):this._likeCard(this,this._cardId)}deleteCardElement(){this._delete.closest(".element").remove()}_setEventHandlers=()=>{this._delete.addEventListener("click",(()=>this._deleteCard(this,this._cardId))),this._like.addEventListener("click",(()=>this._likeCardForUser())),this._image.addEventListener("click",(()=>this._handleCardClick(this._name,this._link)))};_fillCard=()=>{this._isLike()?this._like.classList.add("like__vector_active"):this._like.classList.remove("like__vector_active"),!1===this._isYourCard()&&this._card.querySelector(".element__del").remove(),this._likeQuantityCard.textContent=this._likeQuantity.length,this._image.src=this._link,this._image.alt=this._name,this._title.textContent=this._name}},e=class{constructor(t,e){this._formElement=t,this._config=e}resetValidation(){this._toggleButtonState(),this._inputList.forEach((t=>{this._hideInputError(t)}))}_showInputError=t=>{const e=this._formElement.querySelector(`.${t.id}-error`);e.classList.add(this._config.errorClass),e.textContent=t.validationMessage,t.classList.add(this._config.inputErrorClass)};_hideInputError=t=>{const e=this._formElement.querySelector(`.${t.id}-error`);e.classList.remove(this._config.errorClass),e.textContent="",t.classList.remove(this._config.inputErrorClass)};_checkInputValidity(t){t.validity.valid?this._hideInputError(t):this._showInputError(t)}_hasInvalidInput(){return this._inputList.some((t=>!t.validity.valid))}_toggleButtonState(){this._hasInvalidInput(this._inputList)?(this._buttonElement.classList.remove(this._config.activeButtonClass),this._buttonElement.classList.add(this._config.inactiveButtonClass),this._buttonElement.disabled=!0):(this._buttonElement.classList.add(this._config.activeButtonClass),this._buttonElement.classList.remove(this._config.inactiveButtonClass),this._buttonElement.disabled=!1)}_setEventListeners(){this._inputList=Array.from(this._formElement.querySelectorAll(this._config.inputSelector)),this._buttonElement=this._formElement.querySelector(this._config.submitButtonSelector),this._toggleButtonState(),this._inputList.forEach((t=>{t.addEventListener("input",(()=>{this._checkInputValidity(t),this._toggleButtonState()}))}))}enableValidation(){this._setEventListeners()}};class s{constructor({items:t,renderer:e},s){this._initialArray=t,this._renderer=e,this._container=document.querySelector(s)}renderItems(){this._initialArray.forEach((t=>{const e=this._renderer(t);this.addItem(e)}))}addItem(t){this._container.prepend(t)}}class i{constructor(t){this._popup=document.querySelector(t),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(t){"Escape"==t.code&&this.close()}setEventListeners(){this._popup.querySelector(".popup__close").addEventListener("click",(()=>{this.close()})),this._popup.addEventListener("mousedown",(t=>{t.currentTarget===t.target&&this.close()}))}}class n extends i{constructor(t,e){super(t),this._handleFormSubmit=e,this._form=this._popup.querySelector(".popup__form"),this._inputList=Array.from(this._form.querySelectorAll(".popup__input")),this._buttonSubmit=this._popup.querySelector(".popup__button-submit")}_getInputValues(){return this._formValues={},this._inputList.forEach((t=>{this._formValues[t.name]=t.value})),this._formValues}renameButton(){this._buttonSubmit.textContent="Сохранение..."}nameButton(){this._buttonSubmit.textContent="Сохранить"}close(){super.close(),this._form.reset()}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(t=>{t.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}}const r={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button-submit",activeButtonClass:"popup__button-submit_valid",inactiveButtonClass:"popup__button-submit_invalid",inputErrorClass:"popup__input_type_error",errorClass:"popup__input-error_visible"},o=document.querySelector(".popup_type_edit-profile"),a=o.querySelector("#editForm"),l=document.querySelector(".info__edit-button"),_=(document.querySelector(".info__title"),document.querySelector(".info__subtitle"),o.querySelector(".popup__input_type_name")),h=o.querySelector(".popup__input_type_job"),c=document.querySelector(".popup_type_edit-avatar").querySelector("#editAvatar"),u=document.querySelector(".popup_type_add-card").querySelector("#addForm"),d=document.querySelector(".profile__add-button"),p=document.querySelector(".profile__avatar-edit");let m;const v=new class{constructor(t,e){this._basePath=t,this._token=e}_getHeaders(){return{"Content-Type":"application/json",authorization:this._token}}_getJson(t){return t.ok?t.json():Promise.reject(`Ошибка: ${t.status}`)}getUserInfo(){return fetch(`${this._basePath}/users/me`,{headers:this._getHeaders()}).then(this._getJson)}getCards(){return fetch(`${this._basePath}/cards`,{headers:this._getHeaders()}).then(this._getJson)}setEditUserInfo(t){return fetch(`${this._basePath}/users/me`,{method:"PATCH",headers:this._getHeaders(),body:JSON.stringify({name:t.name,about:t.job})}).then(this._getJson)}createCard(t){return fetch(`${this._basePath}/cards`,{method:"POST",headers:this._getHeaders(),body:JSON.stringify({name:t.name,link:t.link})}).then(this._getJson)}addLike(t){return fetch(`${this._basePath}/cards/${t}/likes`,{method:"PUT",headers:this._getHeaders()}).then(this._getJson)}deleteLike(t){return fetch(`${this._basePath}/cards/${t}/likes`,{method:"DELETE",headers:this._getHeaders()}).then(this._getJson)}deleteCardApi(t){return fetch(`${this._basePath}/cards/${t}`,{method:"DELETE",headers:this._getHeaders()}).then(this._getJson)}setEditAvatar(t){return fetch(`${this._basePath}/users/me/avatar`,{method:"PATCH",headers:this._getHeaders(),body:JSON.stringify({avatar:t.avatar})}).then(this._getJson)}}("https://mesto.nomoreparties.co/v1/cohort-61","3886a799-4854-4a3c-8a86-4cfa412e7d56"),g=new e(c,r);g.enableValidation();const f=new e(a,r);f.enableValidation();const y=new e(u,r);y.enableValidation();const E=new class extends i{constructor(t){super(t),this._popupImageImg=this._popup.querySelector(".popup__img"),this._popupImageTitle=this._popup.querySelector(".popup__img-title")}open(t,e){super.open(),this._popupImageImg.src=e,this._popupImageImg.alt=t,this._popupImageTitle.textContent=t}close(){super.close(),this._popupImageImg.src="",this._popupImageImg.alt="",this._popupImageTitle.textContent=""}}(".popup_type_img");E.setEventListeners();const k=new class{constructor({name:t,about:e,avatar:s}){this._name=document.querySelector(t),this._about=document.querySelector(e),this._avatar=document.querySelector(s)}getUserInfo(){return{user:this._name.textContent,about:this._about.textContent,_id:this._id,avatar:this._avatar.src}}setUserInfo(t,e,s){this._name.textContent=t,this._about.textContent=e,this._id=s}setUserAvatar(t){this._avatar.src=t}}({name:".info__title",about:".info__subtitle",avatar:".profile__avatar"});Promise.all([v.getUserInfo(),v.getCards()]).then((([t,e])=>{console.log(t),k.setUserInfo(t.name,t.about,t._id,t.avatar),k.setUserAvatar(t.avatar),console.log(e),m=new s({items:e.reverse(),renderer:I},".elements"),m.renderItems()})).catch((t=>{console.log(t)}));const b=new class extends i{constructor(t){super(t),this._button=this._popup.querySelector(".popup__button-submit")}open(t){super.open(),this._handleSubmit=t}setEventListeners(){super.setEventListeners(),this._button.addEventListener("click",(t=>{t.preventDefault(),this._handleSubmit()}))}}(".popup_type_del");b.setEventListeners();const C=new n(".popup_type_edit-profile",(function(t){const{_id:e,avatar:s}=k.getUserInfo();C.renameButton(),v.setEditUserInfo(t).then((()=>{k.setUserInfo(t.name,t.job,e,s),C.close()})).catch((t=>{console.log(t)})).finally((()=>{C.nameButton()}))}));C.setEventListeners(),l.addEventListener("click",(()=>{const{user:t,about:e}=k.getUserInfo();_.value=t,h.value=e,f.resetValidation(),C.open()}));const S=new n(".popup_type_edit-avatar",(function(t){S.renameButton(),v.setEditAvatar(t).then((()=>{k.setUserAvatar(t.avatar),S.close()})).catch((t=>{console.log(t)})).finally((()=>{S.nameButton()}))}));S.setEventListeners(),p.addEventListener("click",(()=>{g.resetValidation(),S.open()}));const L=new n(".popup_type_add-card",(function(t){const e=t.pictureTitle,s=t.pictureLink;L.renameButton(),v.createCard({name:e,link:s}).then((t=>{const e=I(t);m.addItem(e),L.close()})).catch((t=>{console.log(t)})).finally((()=>{L.nameButton()}))}));function I(e){return new t(e,k.getUserInfo(),"#element-template",x,q,B,w).getTemplateCard()}function q(t,e){b.open((()=>{v.deleteCardApi(e).then((()=>{t.deleteCardElement(),b.close()})).catch((t=>{console.log(t)}))}))}function w(t,e){v.deleteLike(e).then((e=>{t.dislikeElement(e)})).catch((t=>{console.log(t)}))}function B(t,e){v.addLike(e).then((e=>{t.likeElement(e)})).catch((t=>{console.log(t)}))}function x(t,e){E.open(t,e)}L.setEventListeners(),d.addEventListener("click",(()=>{y.resetValidation(),L.open()}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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TCxFQUFZd00sRUFBTWpNLEdBQ3pCNkgsRUFDRzhCLFdBQVczSixHQUNYOEksTUFBTXJILElBQ0x3SyxFQUFLbkssZUFBZUwsRUFBUyxJQUU5QndKLE9BQU9DLElBQ05KLFFBQVFDLElBQUlHLEVBQUksR0FFdEIsQ0FFQSxTQUFTMUwsRUFBU3lNLEVBQU1qTSxHQUN0QjZILEVBQ0c0QixRQUFRekosR0FDUjhJLE1BQU1ySCxJQUNMd0ssRUFBS3pLLFlBQVlDLEVBQVMsSUFFM0J3SixPQUFPQyxJQUNOSixRQUFRQyxJQUFJRyxFQUFJLEdBRXRCLENBRUEsU0FBUzVMLEVBQWdCTSxFQUFNRSxHQUM3QnFLLEVBQWV4RSxLQUFLL0YsRUFBTUUsRUFDNUIsQ0E5RUE2TCxFQUFhM0Ysb0JBc0JiMEIsRUFBZW5GLGlCQUFpQixTQUFTLEtBQ3ZDMkgsRUFBb0JwSCxrQkFDcEI2SSxFQUFhaEcsTUFBTSxHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcHJha3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9wcmFrdGljdW0vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3ByYWt0aWN1bS8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vcHJha3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vcHJha3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9wcmFrdGljdW0vLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vcHJha3RpY3VtLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9wcmFrdGljdW0vLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vcHJha3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vcHJha3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vcHJha3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQ29uZmlybWF0aW9uUG9wdXAuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY2xhc3MgQ2FyZCB7XHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBpdGVtLFxyXG4gICAgdXNlcixcclxuICAgIHRlbXBsYXRlLFxyXG4gICAgaGFuZGxlQ2FyZENsaWNrLFxyXG4gICAgZGVsZXRlQ2FyZCxcclxuICAgIGxpa2VDYXJkLFxyXG4gICAgZGlzbGlrZUNhcmRcclxuICApIHtcclxuICAgIHRoaXMuX25hbWUgPSBpdGVtLm5hbWU7XHJcbiAgICB0aGlzLl9saW5rID0gaXRlbS5saW5rO1xyXG4gICAgdGhpcy5fdXNlcklkID0gdXNlci5faWQ7XHJcbiAgICB0aGlzLl9vd25lcklkID0gaXRlbS5vd25lci5faWQ7XHJcbiAgICB0aGlzLl9jYXJkSWQgPSBpdGVtLl9pZDtcclxuICAgIHRoaXMuX3RlbXBsYXRlID0gdGVtcGxhdGU7XHJcbiAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sgPSBoYW5kbGVDYXJkQ2xpY2s7XHJcbiAgICB0aGlzLl9kZWxldGVDYXJkID0gZGVsZXRlQ2FyZDtcclxuICAgIHRoaXMuX2xpa2VDYXJkID0gbGlrZUNhcmQ7XHJcbiAgICB0aGlzLl9kaXNsaWtlQ2FyZCA9IGRpc2xpa2VDYXJkO1xyXG4gICAgdGhpcy5fbGlrZVF1YW50aXR5ID0gaXRlbS5saWtlcztcclxuICB9XHJcblxyXG4gIGdldFRlbXBsYXRlQ2FyZCA9ICgpID0+IHtcclxuICAgIHRoaXMuX2NhcmQgPSBkb2N1bWVudFxyXG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl90ZW1wbGF0ZSlcclxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50c19fZWxlbWVudFwiKVxyXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG4gICAgdGhpcy5fbGlrZSA9IHRoaXMuX2NhcmQucXVlcnlTZWxlY3RvcihcIi5saWtlX192ZWN0b3JcIik7XHJcbiAgICB0aGlzLl9saWtlUXVhbnRpdHlDYXJkID0gdGhpcy5fY2FyZC5xdWVyeVNlbGVjdG9yKFwiLmxpa2VfX3F1YW50aXR5XCIpO1xyXG4gICAgdGhpcy5fdGl0bGUgPSB0aGlzLl9jYXJkLnF1ZXJ5U2VsZWN0b3IoXCIuZGVzY3JpcHRpb25fX3RpdGxlXCIpO1xyXG4gICAgdGhpcy5faW1hZ2UgPSB0aGlzLl9jYXJkLnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudF9faW1hZ2VcIik7XHJcbiAgICB0aGlzLl9kZWxldGUgPSB0aGlzLl9jYXJkLnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudF9fZGVsXCIpO1xyXG5cclxuICAgIHRoaXMuX2ZpbGxDYXJkKCk7XHJcbiAgICB0aGlzLl9zZXRFdmVudEhhbmRsZXJzKCk7XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuX2NhcmQ7XHJcbiAgfTtcclxuXHJcbiAgbGlrZUVsZW1lbnQoY2FyZERhdGEpIHtcclxuICAgIHRoaXMuX2xpa2VRdWFudGl0eUNhcmQudGV4dENvbnRlbnQgPSBjYXJkRGF0YS5saWtlcy5sZW5ndGg7XHJcbiAgICB0aGlzLl9saWtlUXVhbnRpdHkgPSBjYXJkRGF0YS5saWtlcztcclxuICAgIHRoaXMuX2xpa2UuY2xhc3NMaXN0LmFkZChcImxpa2VfX3ZlY3Rvcl9hY3RpdmVcIik7XHJcbiAgfVxyXG5cclxuICBkaXNsaWtlRWxlbWVudChjYXJkRGF0YSkge1xyXG4gICAgdGhpcy5fbGlrZS5jbGFzc0xpc3QucmVtb3ZlKFwibGlrZV9fdmVjdG9yX2FjdGl2ZVwiKTtcclxuICAgIHRoaXMuX2xpa2VRdWFudGl0eUNhcmQudGV4dENvbnRlbnQgPSBjYXJkRGF0YS5saWtlcy5sZW5ndGg7XHJcbiAgICB0aGlzLl9saWtlUXVhbnRpdHkgPSBjYXJkRGF0YS5saWtlcztcclxuICB9XHJcblxyXG4gIF9pc0xpa2UgPSAoKSA9PiB7XHJcbiAgICByZXR1cm4gdGhpcy5fbGlrZVF1YW50aXR5LmZpbmQoXHJcbiAgICAgIChlbGVtZW50SWQpID0+IGVsZW1lbnRJZC5faWQgPT09IHRoaXMuX3VzZXJJZFxyXG4gICAgKTtcclxuICB9O1xyXG5cclxuICBfaXNZb3VyQ2FyZCgpIHtcclxuICAgIGlmICh0aGlzLl9vd25lcklkID09PSB0aGlzLl91c2VySWQpIHtcclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfbGlrZUNhcmRGb3JVc2VyKCkge1xyXG4gICAgaWYgKHRoaXMuX2lzTGlrZSgpKSB7XHJcbiAgICAgIHRoaXMuX2Rpc2xpa2VDYXJkKHRoaXMsIHRoaXMuX2NhcmRJZCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9saWtlQ2FyZCh0aGlzLCB0aGlzLl9jYXJkSWQpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZGVsZXRlQ2FyZEVsZW1lbnQoKSB7XHJcbiAgICB0aGlzLl9kZWxldGUuY2xvc2VzdChcIi5lbGVtZW50XCIpLnJlbW92ZSgpO1xyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50SGFuZGxlcnMgPSAoKSA9PiB7XHJcbiAgICB0aGlzLl9kZWxldGUuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+XHJcbiAgICAgIHRoaXMuX2RlbGV0ZUNhcmQodGhpcywgdGhpcy5fY2FyZElkKVxyXG4gICAgKTtcclxuXHJcbiAgICB0aGlzLl9saWtlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB0aGlzLl9saWtlQ2FyZEZvclVzZXIoKSk7XHJcblxyXG4gICAgdGhpcy5faW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+XHJcbiAgICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayh0aGlzLl9uYW1lLCB0aGlzLl9saW5rKVxyXG4gICAgKTtcclxuICB9O1xyXG5cclxuICBfZmlsbENhcmQgPSAoKSA9PiB7XHJcbiAgICBpZiAodGhpcy5faXNMaWtlKCkpIHtcclxuICAgICAgdGhpcy5fbGlrZS5jbGFzc0xpc3QuYWRkKFwibGlrZV9fdmVjdG9yX2FjdGl2ZVwiKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2xpa2UuY2xhc3NMaXN0LnJlbW92ZShcImxpa2VfX3ZlY3Rvcl9hY3RpdmVcIik7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHRoaXMuX2lzWW91ckNhcmQoKSA9PT0gZmFsc2UpIHtcclxuICAgICAgY29uc3QgZGVsZXRlRWxlbWVudCA9IHRoaXMuX2NhcmQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X19kZWxcIik7XHJcbiAgICAgIGRlbGV0ZUVsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5fbGlrZVF1YW50aXR5Q2FyZC50ZXh0Q29udGVudCA9IHRoaXMuX2xpa2VRdWFudGl0eS5sZW5ndGg7XHJcbiAgICB0aGlzLl9pbWFnZS5zcmMgPSB0aGlzLl9saW5rO1xyXG4gICAgdGhpcy5faW1hZ2UuYWx0ID0gdGhpcy5fbmFtZTtcclxuICAgIHRoaXMuX3RpdGxlLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcclxuICB9O1xyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBDYXJkO1xyXG4iLCJjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICBjb25zdHJ1Y3Rvcihmb3JtRWxlbWVudCwgY29uZmlnKSB7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xyXG4gICAgdGhpcy5fY29uZmlnID0gY29uZmlnO1xyXG4gIH1cclxuICByZXNldFZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBfc2hvd0lucHV0RXJyb3IgPSAoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcclxuICAgICk7XHJcblxyXG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fY29uZmlnLmVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XHJcbiAgfTtcclxuXHJcbiAgX2hpZGVJbnB1dEVycm9yID0gKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXHJcbiAgICApO1xyXG5cclxuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2NvbmZpZy5lcnJvckNsYXNzKTtcclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9jb25maWcuaW5wdXRFcnJvckNsYXNzKTtcclxuICB9O1xyXG5cclxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xyXG4gICAgaWYgKGlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5faW5wdXRMaXN0LnNvbWUoKGlucHV0RWxlbWVudCkgPT4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCk7XHJcbiAgfVxyXG5cclxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XHJcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KHRoaXMuX2lucHV0TGlzdCkpIHtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2NvbmZpZy5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9jb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2NvbmZpZy5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9jb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2lucHV0TGlzdCA9IEFycmF5LmZyb20oXHJcbiAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5fY29uZmlnLmlucHV0U2VsZWN0b3IpXHJcbiAgICApO1xyXG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIHRoaXMuX2NvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3RvclxyXG4gICAgKTtcclxuXHJcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG5cclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XHJcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgRm9ybVZhbGlkYXRvcjtcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XHJcbiAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgc2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX2luaXRpYWxBcnJheSA9IGl0ZW1zO1xyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuXHJcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKTtcclxuICB9XHJcbiAgcmVuZGVySXRlbXMoKSB7XHJcbiAgICB0aGlzLl9pbml0aWFsQXJyYXkuZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG4gICAgICBjb25zdCByZW5kZXJDYXJkID0gdGhpcy5fcmVuZGVyZXIoaXRlbSk7XHJcbiAgICAgIHRoaXMuYWRkSXRlbShyZW5kZXJDYXJkKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgYWRkSXRlbShlbGVtZW50KSB7XHJcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwKSB7XHJcbiAgICB0aGlzLl9wb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXApO1xyXG4gICAgdGhpcy5faGFuZGxlRXNjQ2xvc2UgPSB0aGlzLl9oYW5kbGVFc2NDbG9zZS5iaW5kKHRoaXMpO1xyXG4gIH1cclxuXHJcbiAgb3BlbigpIHtcclxuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5yZW1vdmUoXCJwb3B1cF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlRXNjQ2xvc2UoZXZ0KSB7XHJcbiAgICBpZiAoZXZ0LmNvZGUgPT0gXCJFc2NhcGVcIikge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIGNvbnN0IGJ1dHRvbkNsb3NlID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fY2xvc2VcIik7XHJcbiAgICBidXR0b25DbG9zZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICB0aGlzLl9wb3B1cC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChldnQpID0+IHtcclxuICAgICAgaWYgKGV2dC5jdXJyZW50VGFyZ2V0ID09PSBldnQudGFyZ2V0KSB7XHJcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwLCBoYW5kbGVGb3JtU3VibWl0KSB7XHJcbiAgICBzdXBlcihwb3B1cCk7XHJcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcclxuICAgIHRoaXMuX2Zvcm0gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19mb3JtXCIpO1xyXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbSh0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCIucG9wdXBfX2lucHV0XCIpKTtcclxuICAgIHRoaXMuX2J1dHRvblN1Ym1pdCA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2J1dHRvbi1zdWJtaXRcIik7XHJcbiAgfVxyXG5cclxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICB0aGlzLl9mb3JtVmFsdWVzID0ge307XHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgdGhpcy5fZm9ybVZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gdGhpcy5fZm9ybVZhbHVlcztcclxuICB9XHJcblxyXG4gIHJlbmFtZUJ1dHRvbigpIHtcclxuICAgIHRoaXMuX2J1dHRvblN1Ym1pdC50ZXh0Q29udGVudCA9IFwi0KHQvtGF0YDQsNC90LXQvdC40LUuLi5cIjtcclxuICB9XHJcblxyXG4gIG5hbWVCdXR0b24oKSB7XHJcbiAgICB0aGlzLl9idXR0b25TdWJtaXQudGV4dENvbnRlbnQgPSBcItCh0L7RhdGA0LDQvdC40YLRjFwiO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICBzdXBlci5jbG9zZSgpO1xyXG4gICAgdGhpcy5fZm9ybS5yZXNldCgpO1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3RvcihiYXNlUGF0aCwgdG9rZW4pIHtcclxuICAgIHRoaXMuX2Jhc2VQYXRoID0gYmFzZVBhdGg7XHJcbiAgICB0aGlzLl90b2tlbiA9IHRva2VuO1xyXG4gIH1cclxuXHJcbiAgX2dldEhlYWRlcnMoKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5fdG9rZW4sXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgX2dldEpzb24ocmVzKSB7XHJcbiAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGDQntGI0LjQsdC60LA6ICR7cmVzLnN0YXR1c31gKTtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VQYXRofS91c2Vycy9tZWAsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5fZ2V0SGVhZGVycygpLFxyXG4gICAgfSkudGhlbih0aGlzLl9nZXRKc29uKTtcclxuICB9XHJcblxyXG4gIGdldENhcmRzKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VQYXRofS9jYXJkc2AsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5fZ2V0SGVhZGVycygpLFxyXG4gICAgfSkudGhlbih0aGlzLl9nZXRKc29uKTtcclxuICB9XHJcblxyXG4gIHNldEVkaXRVc2VySW5mbyhkYXRhKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVBhdGh9L3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5fZ2V0SGVhZGVycygpLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICAgIGFib3V0OiBkYXRhLmpvYixcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2dldEpzb24pO1xyXG4gIH1cclxuXHJcbiAgY3JlYXRlQ2FyZChpdGVtKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVBhdGh9L2NhcmRzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9nZXRIZWFkZXJzKCksXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiBpdGVtLm5hbWUsXHJcbiAgICAgICAgbGluazogaXRlbS5saW5rLFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4odGhpcy5fZ2V0SnNvbik7XHJcbiAgfVxyXG5cclxuICBhZGRMaWtlKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VQYXRofS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5fZ2V0SGVhZGVycygpLFxyXG4gICAgfSkudGhlbih0aGlzLl9nZXRKc29uKTtcclxuICB9XHJcblxyXG4gIGRlbGV0ZUxpa2UoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVBhdGh9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9nZXRIZWFkZXJzKCksXHJcbiAgICB9KS50aGVuKHRoaXMuX2dldEpzb24pO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlQ2FyZEFwaShjYXJkSWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlUGF0aH0vY2FyZHMvJHtjYXJkSWR9YCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2dldEhlYWRlcnMoKSxcclxuICAgIH0pLnRoZW4odGhpcy5fZ2V0SnNvbik7XHJcbiAgfVxyXG5cclxuICBzZXRFZGl0QXZhdGFyKGRhdGEpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlUGF0aH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5fZ2V0SGVhZGVycygpLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgYXZhdGFyOiBkYXRhLmF2YXRhcixcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2dldEpzb24pO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgQXBpO1xyXG4iLCJjb25zdCB2YWxpZGF0aW9uQ29uZmlnID0ge1xyXG4gIGZvcm1TZWxlY3RvcjogXCIucG9wdXBfX2Zvcm1cIixcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5wb3B1cF9faW5wdXRcIixcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIucG9wdXBfX2J1dHRvbi1zdWJtaXRcIixcclxuICBhY3RpdmVCdXR0b25DbGFzczogXCJwb3B1cF9fYnV0dG9uLXN1Ym1pdF92YWxpZFwiLFxyXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwicG9wdXBfX2J1dHRvbi1zdWJtaXRfaW52YWxpZFwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJwb3B1cF9faW5wdXRfdHlwZV9lcnJvclwiLFxyXG4gIGVycm9yQ2xhc3M6IFwicG9wdXBfX2lucHV0LWVycm9yX3Zpc2libGVcIixcclxufTtcclxuXHJcbmNvbnN0IGNhcmRzQ29udGFpbmVyID0gXCIuZWxlbWVudHNcIjtcclxuXHJcbmNvbnN0IHBvcHVwUHJvZmlsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfdHlwZV9lZGl0LXByb2ZpbGVcIik7XHJcbmNvbnN0IGZvcm1FZGl0RWxlbWVudCA9IHBvcHVwUHJvZmlsZS5xdWVyeVNlbGVjdG9yKFwiI2VkaXRGb3JtXCIpO1xyXG5jb25zdCBwb3B1cEVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmluZm9fX2VkaXQtYnV0dG9uXCIpO1xyXG5jb25zdCBpbmZvVGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmluZm9fX3RpdGxlXCIpO1xyXG5jb25zdCBpbmZvU3VidGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmluZm9fX3N1YnRpdGxlXCIpO1xyXG5cclxuY29uc3QgcG9wdXBOYW1lID0gcG9wdXBQcm9maWxlLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2lucHV0X3R5cGVfbmFtZVwiKTtcclxuY29uc3QgcG9wdXBKb2IgPSBwb3B1cFByb2ZpbGUucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9faW5wdXRfdHlwZV9qb2JcIik7XHJcblxyXG5jb25zdCBwb3B1cEVkaXRBdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX3R5cGVfZWRpdC1hdmF0YXJcIik7XHJcbmNvbnN0IGZvcm1FZGl0QXZhdGFyID0gcG9wdXBFZGl0QXZhdGFyLnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdEF2YXRhclwiKTtcclxuXHJcbmNvbnN0IHBvcHVwQ2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfdHlwZV9hZGQtY2FyZFwiKTtcclxuY29uc3QgZm9ybUFkZEVsZW1lbnQgPSBwb3B1cENhcmQucXVlcnlTZWxlY3RvcihcIiNhZGRGb3JtXCIpO1xyXG5jb25zdCBwb3B1cEFkZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcclxuXHJcbmNvbnN0IGJ1dHRvbkVkaXRBdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2F2YXRhci1lZGl0XCIpO1xyXG5cclxuZXhwb3J0IHtcclxuICB2YWxpZGF0aW9uQ29uZmlnLFxyXG4gIGNhcmRzQ29udGFpbmVyLFxyXG4gIGZvcm1FZGl0RWxlbWVudCxcclxuICBwb3B1cEVkaXRCdXR0b24sXHJcbiAgaW5mb1RpdGxlLFxyXG4gIGluZm9TdWJ0aXRsZSxcclxuICBmb3JtQWRkRWxlbWVudCxcclxuICBwb3B1cEFkZEJ1dHRvbixcclxuICBwb3B1cE5hbWUsXHJcbiAgcG9wdXBKb2IsXHJcbiAgYnV0dG9uRWRpdEF2YXRhcixcclxuICBmb3JtRWRpdEF2YXRhcixcclxufTtcclxuIiwiaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xyXG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XHJcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XHJcbmltcG9ydCBBcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpLmpzXCI7XHJcbmltcG9ydCBDb25maXJtYXRpb25Qb3B1cCBmcm9tIFwiLi4vY29tcG9uZW50cy9Db25maXJtYXRpb25Qb3B1cC5qc1wiO1xyXG5pbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xyXG5pbXBvcnQge1xyXG4gIHZhbGlkYXRpb25Db25maWcsXHJcbiAgZm9ybUVkaXRFbGVtZW50LFxyXG4gIGNhcmRzQ29udGFpbmVyLFxyXG4gIHBvcHVwRWRpdEJ1dHRvbixcclxuICBmb3JtQWRkRWxlbWVudCxcclxuICBwb3B1cEFkZEJ1dHRvbixcclxuICBwb3B1cE5hbWUsXHJcbiAgcG9wdXBKb2IsXHJcbiAgYnV0dG9uRWRpdEF2YXRhcixcclxuICBmb3JtRWRpdEF2YXRhcixcclxufSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XHJcblxyXG5sZXQgY2FyZHNCYXNrZXQ7XHJcblxyXG5jb25zdCBhcGkgPSBuZXcgQXBpKFxyXG4gIFwiaHR0cHM6Ly9tZXN0by5ub21vcmVwYXJ0aWVzLmNvL3YxL2NvaG9ydC02MVwiLFxyXG4gIFwiMzg4NmE3OTktNDg1NC00YTNjLThhODYtNGNmYTQxMmU3ZDU2XCJcclxuKTtcclxuXHJcbmV4cG9ydCB7IGFwaSB9O1xyXG5cclxuY29uc3QgZm9ybUF2YXRhclZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGZvcm1FZGl0QXZhdGFyLCB2YWxpZGF0aW9uQ29uZmlnKTtcclxuZm9ybUF2YXRhclZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcblxyXG5jb25zdCBmb3JtUHJvZmlsZVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFxyXG4gIGZvcm1FZGl0RWxlbWVudCxcclxuICB2YWxpZGF0aW9uQ29uZmlnXHJcbik7XHJcbmZvcm1Qcm9maWxlVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuXHJcbmNvbnN0IGVuYWJsZVZhbGlkYXRpb25BZGQgPSBuZXcgRm9ybVZhbGlkYXRvcihmb3JtQWRkRWxlbWVudCwgdmFsaWRhdGlvbkNvbmZpZyk7XHJcbmVuYWJsZVZhbGlkYXRpb25BZGQuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5cclxuY29uc3QgcG9wdXBXaXRoSW1hZ2UgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCIucG9wdXBfdHlwZV9pbWdcIik7XHJcbnBvcHVwV2l0aEltYWdlLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyh7XHJcbiAgbmFtZTogXCIuaW5mb19fdGl0bGVcIixcclxuICBhYm91dDogXCIuaW5mb19fc3VidGl0bGVcIixcclxuICBhdmF0YXI6IFwiLnByb2ZpbGVfX2F2YXRhclwiLFxyXG59KTtcclxuXHJcblByb21pc2UuYWxsKFthcGkuZ2V0VXNlckluZm8oKSwgYXBpLmdldENhcmRzKCldKVxyXG4gIC50aGVuKChbdXNlckluZm9BcGksIGl0ZW1zQXBpXSkgPT4ge1xyXG4gICAgY29uc29sZS5sb2codXNlckluZm9BcGkpO1xyXG4gICAgdXNlckluZm8uc2V0VXNlckluZm8oXHJcbiAgICAgIHVzZXJJbmZvQXBpLm5hbWUsXHJcbiAgICAgIHVzZXJJbmZvQXBpLmFib3V0LFxyXG4gICAgICB1c2VySW5mb0FwaS5faWQsXHJcbiAgICAgIHVzZXJJbmZvQXBpLmF2YXRhclxyXG4gICAgKTtcclxuICAgIHVzZXJJbmZvLnNldFVzZXJBdmF0YXIodXNlckluZm9BcGkuYXZhdGFyKTtcclxuXHJcbiAgICBjb25zb2xlLmxvZyhpdGVtc0FwaSk7XHJcbiAgICBjYXJkc0Jhc2tldCA9IG5ldyBTZWN0aW9uKFxyXG4gICAgICB7XHJcbiAgICAgICAgaXRlbXM6IGl0ZW1zQXBpLnJldmVyc2UoKSxcclxuICAgICAgICByZW5kZXJlcjogY3JlYXRlQ2FyZCxcclxuICAgICAgfSxcclxuICAgICAgY2FyZHNDb250YWluZXJcclxuICAgICk7XHJcbiAgICBjYXJkc0Jhc2tldC5yZW5kZXJJdGVtcygpO1xyXG4gIH0pXHJcbiAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgfSk7XHJcblxyXG5jb25zdCBwb3B1cERlbGV0ZUNhcmQgPSBuZXcgQ29uZmlybWF0aW9uUG9wdXAoXCIucG9wdXBfdHlwZV9kZWxcIik7XHJcbnBvcHVwRGVsZXRlQ2FyZC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5leHBvcnQgeyBwb3B1cERlbGV0ZUNhcmQgfTtcclxuXHJcbmNvbnN0IHBvcHVwRWRpdEZvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICBcIi5wb3B1cF90eXBlX2VkaXQtcHJvZmlsZVwiLFxyXG4gIHN1Ym1pdFByb2ZpbGVGb3JtXHJcbik7XHJcbnBvcHVwRWRpdEZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbnBvcHVwRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGNvbnN0IHsgdXNlciwgYWJvdXQgfSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XHJcbiAgcG9wdXBOYW1lLnZhbHVlID0gdXNlcjtcclxuICBwb3B1cEpvYi52YWx1ZSA9IGFib3V0O1xyXG4gIGZvcm1Qcm9maWxlVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gIHBvcHVwRWRpdEZvcm0ub3BlbigpO1xyXG59KTtcclxuXHJcbmZ1bmN0aW9uIHN1Ym1pdFByb2ZpbGVGb3JtKGlucHV0VmFsdWVzKSB7XHJcbiAgY29uc3QgeyBfaWQsIGF2YXRhciB9ID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcclxuICBwb3B1cEVkaXRGb3JtLnJlbmFtZUJ1dHRvbigpO1xyXG4gIGFwaVxyXG4gICAgLnNldEVkaXRVc2VySW5mbyhpbnB1dFZhbHVlcylcclxuICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgdXNlckluZm8uc2V0VXNlckluZm8oaW5wdXRWYWx1ZXMubmFtZSwgaW5wdXRWYWx1ZXMuam9iLCBfaWQsIGF2YXRhcik7XHJcbiAgICAgIHBvcHVwRWRpdEZvcm0uY2xvc2UoKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgfSlcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgcG9wdXBFZGl0Rm9ybS5uYW1lQnV0dG9uKCk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuY29uc3QgcG9wdXBFZGl0QXZhdGFyRm9ybSA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gIFwiLnBvcHVwX3R5cGVfZWRpdC1hdmF0YXJcIixcclxuICBzdWJtaXRBdmF0YXJGb3JtXHJcbik7XHJcbnBvcHVwRWRpdEF2YXRhckZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmJ1dHRvbkVkaXRBdmF0YXIuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBmb3JtQXZhdGFyVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gIHBvcHVwRWRpdEF2YXRhckZvcm0ub3BlbigpO1xyXG59KTtcclxuXHJcbmZ1bmN0aW9uIHN1Ym1pdEF2YXRhckZvcm0oaW5wdXRWYWx1ZXMpIHtcclxuICBwb3B1cEVkaXRBdmF0YXJGb3JtLnJlbmFtZUJ1dHRvbigpO1xyXG4gIGFwaVxyXG4gICAgLnNldEVkaXRBdmF0YXIoaW5wdXRWYWx1ZXMpXHJcbiAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJBdmF0YXIoaW5wdXRWYWx1ZXMuYXZhdGFyKTtcclxuICAgICAgcG9wdXBFZGl0QXZhdGFyRm9ybS5jbG9zZSgpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICB9KVxyXG5cclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgcG9wdXBFZGl0QXZhdGFyRm9ybS5uYW1lQnV0dG9uKCk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuY29uc3QgcG9wdXBBZGRGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIucG9wdXBfdHlwZV9hZGQtY2FyZFwiLCBzdWJtaXRDYXJkRm9ybSk7XHJcbnBvcHVwQWRkRm9ybS5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuZnVuY3Rpb24gc3VibWl0Q2FyZEZvcm0oaW5wdXRWYWx1ZXMpIHtcclxuICBjb25zdCBuYW1lID0gaW5wdXRWYWx1ZXMucGljdHVyZVRpdGxlO1xyXG4gIGNvbnN0IGxpbmsgPSBpbnB1dFZhbHVlcy5waWN0dXJlTGluaztcclxuICBwb3B1cEFkZEZvcm0ucmVuYW1lQnV0dG9uKCk7XHJcblxyXG4gIGFwaVxyXG4gICAgLmNyZWF0ZUNhcmQoeyBuYW1lLCBsaW5rIH0pXHJcbiAgICAudGhlbigobmV3SXRlbSkgPT4ge1xyXG4gICAgICBjb25zdCBuZXdDYXJkID0gY3JlYXRlQ2FyZChuZXdJdGVtKTtcclxuICAgICAgY2FyZHNCYXNrZXQuYWRkSXRlbShuZXdDYXJkKTtcclxuICAgICAgcG9wdXBBZGRGb3JtLmNsb3NlKCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgIH0pXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIHBvcHVwQWRkRm9ybS5uYW1lQnV0dG9uKCk7XHJcbiAgICB9KTtcclxufVxyXG5cclxucG9wdXBBZGRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBlbmFibGVWYWxpZGF0aW9uQWRkLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gIHBvcHVwQWRkRm9ybS5vcGVuKCk7XHJcbn0pO1xyXG5cclxuZnVuY3Rpb24gY3JlYXRlQ2FyZChpdGVtKSB7XHJcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKFxyXG4gICAgaXRlbSxcclxuICAgIHVzZXJJbmZvLmdldFVzZXJJbmZvKCksXHJcbiAgICBcIiNlbGVtZW50LXRlbXBsYXRlXCIsXHJcbiAgICBoYW5kbGVDYXJkQ2xpY2ssXHJcbiAgICBkZWxldGVDYXJkLFxyXG4gICAgbGlrZUNhcmQsXHJcbiAgICBkaXNsaWtlQ2FyZFxyXG4gICkuZ2V0VGVtcGxhdGVDYXJkKCk7XHJcbiAgcmV0dXJuIGNhcmQ7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGRlbGV0ZUNhcmQoY2FyZCwgX2lkKSB7XHJcbiAgcG9wdXBEZWxldGVDYXJkLm9wZW4oKCkgPT4ge1xyXG4gICAgYXBpXHJcbiAgICAgIC5kZWxldGVDYXJkQXBpKF9pZClcclxuICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgIGNhcmQuZGVsZXRlQ2FyZEVsZW1lbnQoKTtcclxuICAgICAgICBwb3B1cERlbGV0ZUNhcmQuY2xvc2UoKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgICB9KTtcclxuICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gZGlzbGlrZUNhcmQoY2FyZCwgX2lkKSB7XHJcbiAgYXBpXHJcbiAgICAuZGVsZXRlTGlrZShfaWQpXHJcbiAgICAudGhlbigoY2FyZERhdGEpID0+IHtcclxuICAgICAgY2FyZC5kaXNsaWtlRWxlbWVudChjYXJkRGF0YSk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBsaWtlQ2FyZChjYXJkLCBfaWQpIHtcclxuICBhcGlcclxuICAgIC5hZGRMaWtlKF9pZClcclxuICAgIC50aGVuKChjYXJkRGF0YSkgPT4ge1xyXG4gICAgICBjYXJkLmxpa2VFbGVtZW50KGNhcmREYXRhKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUNhcmRDbGljayhuYW1lLCBsaW5rKSB7XHJcbiAgcG9wdXBXaXRoSW1hZ2Uub3BlbihuYW1lLCBsaW5rKTtcclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwKSB7XHJcbiAgICBzdXBlcihwb3B1cCk7XHJcbiAgICB0aGlzLl9wb3B1cEltYWdlSW1nID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9faW1nXCIpO1xyXG4gICAgdGhpcy5fcG9wdXBJbWFnZVRpdGxlID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9faW1nLXRpdGxlXCIpO1xyXG4gIH1cclxuXHJcbiAgb3BlbihuYW1lLCBsaW5rKSB7XHJcbiAgICBzdXBlci5vcGVuKCk7XHJcbiAgICB0aGlzLl9wb3B1cEltYWdlSW1nLnNyYyA9IGxpbms7XHJcbiAgICB0aGlzLl9wb3B1cEltYWdlSW1nLmFsdCA9IG5hbWU7XHJcbiAgICB0aGlzLl9wb3B1cEltYWdlVGl0bGUudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICBzdXBlci5jbG9zZSgpO1xyXG4gICAgdGhpcy5fcG9wdXBJbWFnZUltZy5zcmMgPSBcIlwiO1xyXG4gICAgdGhpcy5fcG9wdXBJbWFnZUltZy5hbHQgPSBcIlwiO1xyXG4gICAgdGhpcy5fcG9wdXBJbWFnZVRpdGxlLnRleHRDb250ZW50ID0gXCJcIjtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xyXG4gIGNvbnN0cnVjdG9yKHsgbmFtZSwgYWJvdXQsIGF2YXRhciB9KSB7XHJcbiAgICB0aGlzLl9uYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lKTtcclxuICAgIHRoaXMuX2Fib3V0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhYm91dCk7XHJcbiAgICB0aGlzLl9hdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGF2YXRhcik7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHVzZXI6IHRoaXMuX25hbWUudGV4dENvbnRlbnQsXHJcbiAgICAgIGFib3V0OiB0aGlzLl9hYm91dC50ZXh0Q29udGVudCxcclxuICAgICAgX2lkOiB0aGlzLl9pZCxcclxuICAgICAgYXZhdGFyOiB0aGlzLl9hdmF0YXIuc3JjLFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIHNldFVzZXJJbmZvKG5hbWUsIGFib3V0LCBfaWQpIHtcclxuICAgIHRoaXMuX25hbWUudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgdGhpcy5fYWJvdXQudGV4dENvbnRlbnQgPSBhYm91dDtcclxuICAgIHRoaXMuX2lkID0gX2lkO1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckF2YXRhcihhdmF0YXIpIHtcclxuICAgIHRoaXMuX2F2YXRhci5zcmMgPSBhdmF0YXI7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ29uZmlybWF0aW9uUG9wdXAgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3Ioc2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2J1dHRvbiA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2J1dHRvbi1zdWJtaXRcIik7XHJcbiAgfVxyXG4gIG9wZW4oaGFuZGxlU3VibWl0KSB7XHJcbiAgICBzdXBlci5vcGVuKCk7XHJcbiAgICB0aGlzLl9oYW5kbGVTdWJtaXQgPSBoYW5kbGVTdWJtaXQ7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLl9idXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCgpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJjb25zdHJ1Y3RvciIsIml0ZW0iLCJ1c2VyIiwidGVtcGxhdGUiLCJoYW5kbGVDYXJkQ2xpY2siLCJkZWxldGVDYXJkIiwibGlrZUNhcmQiLCJkaXNsaWtlQ2FyZCIsInRoaXMiLCJfbmFtZSIsIm5hbWUiLCJfbGluayIsImxpbmsiLCJfdXNlcklkIiwiX2lkIiwiX293bmVySWQiLCJvd25lciIsIl9jYXJkSWQiLCJfdGVtcGxhdGUiLCJfaGFuZGxlQ2FyZENsaWNrIiwiX2RlbGV0ZUNhcmQiLCJfbGlrZUNhcmQiLCJfZGlzbGlrZUNhcmQiLCJfbGlrZVF1YW50aXR5IiwibGlrZXMiLCJnZXRUZW1wbGF0ZUNhcmQiLCJfY2FyZCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJfbGlrZSIsIl9saWtlUXVhbnRpdHlDYXJkIiwiX3RpdGxlIiwiX2ltYWdlIiwiX2RlbGV0ZSIsIl9maWxsQ2FyZCIsIl9zZXRFdmVudEhhbmRsZXJzIiwibGlrZUVsZW1lbnQiLCJjYXJkRGF0YSIsInRleHRDb250ZW50IiwibGVuZ3RoIiwiY2xhc3NMaXN0IiwiYWRkIiwiZGlzbGlrZUVsZW1lbnQiLCJyZW1vdmUiLCJfaXNMaWtlIiwiZmluZCIsImVsZW1lbnRJZCIsIl9pc1lvdXJDYXJkIiwiX2xpa2VDYXJkRm9yVXNlciIsImRlbGV0ZUNhcmRFbGVtZW50IiwiY2xvc2VzdCIsImFkZEV2ZW50TGlzdGVuZXIiLCJzcmMiLCJhbHQiLCJmb3JtRWxlbWVudCIsImNvbmZpZyIsIl9mb3JtRWxlbWVudCIsIl9jb25maWciLCJyZXNldFZhbGlkYXRpb24iLCJfdG9nZ2xlQnV0dG9uU3RhdGUiLCJfaW5wdXRMaXN0IiwiZm9yRWFjaCIsImlucHV0RWxlbWVudCIsIl9oaWRlSW5wdXRFcnJvciIsIl9zaG93SW5wdXRFcnJvciIsImVycm9yRWxlbWVudCIsImlkIiwiZXJyb3JDbGFzcyIsInZhbGlkYXRpb25NZXNzYWdlIiwiaW5wdXRFcnJvckNsYXNzIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGFzSW52YWxpZElucHV0Iiwic29tZSIsIl9idXR0b25FbGVtZW50IiwiYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiZGlzYWJsZWQiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiZW5hYmxlVmFsaWRhdGlvbiIsIlNlY3Rpb24iLCJpdGVtcyIsInJlbmRlcmVyIiwic2VsZWN0b3IiLCJfaW5pdGlhbEFycmF5IiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsInJlbmRlckl0ZW1zIiwicmVuZGVyQ2FyZCIsImFkZEl0ZW0iLCJlbGVtZW50IiwicHJlcGVuZCIsIlBvcHVwIiwicG9wdXAiLCJfcG9wdXAiLCJfaGFuZGxlRXNjQ2xvc2UiLCJiaW5kIiwib3BlbiIsImNsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImV2dCIsImNvZGUiLCJzZXRFdmVudExpc3RlbmVycyIsImN1cnJlbnRUYXJnZXQiLCJ0YXJnZXQiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1cGVyIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfZm9ybSIsIl9idXR0b25TdWJtaXQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJfZm9ybVZhbHVlcyIsImlucHV0IiwidmFsdWUiLCJyZW5hbWVCdXR0b24iLCJuYW1lQnV0dG9uIiwicmVzZXQiLCJwcmV2ZW50RGVmYXVsdCIsInZhbGlkYXRpb25Db25maWciLCJmb3JtU2VsZWN0b3IiLCJwb3B1cFByb2ZpbGUiLCJmb3JtRWRpdEVsZW1lbnQiLCJwb3B1cEVkaXRCdXR0b24iLCJwb3B1cE5hbWUiLCJwb3B1cEpvYiIsImZvcm1FZGl0QXZhdGFyIiwiZm9ybUFkZEVsZW1lbnQiLCJwb3B1cEFkZEJ1dHRvbiIsImJ1dHRvbkVkaXRBdmF0YXIiLCJjYXJkc0Jhc2tldCIsImFwaSIsImJhc2VQYXRoIiwidG9rZW4iLCJfYmFzZVBhdGgiLCJfdG9rZW4iLCJfZ2V0SGVhZGVycyIsImF1dGhvcml6YXRpb24iLCJfZ2V0SnNvbiIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJnZXRVc2VySW5mbyIsImZldGNoIiwiaGVhZGVycyIsInRoZW4iLCJnZXRDYXJkcyIsInNldEVkaXRVc2VySW5mbyIsImRhdGEiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImFib3V0Iiwiam9iIiwiY3JlYXRlQ2FyZCIsImFkZExpa2UiLCJjYXJkSWQiLCJkZWxldGVMaWtlIiwiZGVsZXRlQ2FyZEFwaSIsInNldEVkaXRBdmF0YXIiLCJhdmF0YXIiLCJmb3JtQXZhdGFyVmFsaWRhdG9yIiwiRm9ybVZhbGlkYXRvciIsImZvcm1Qcm9maWxlVmFsaWRhdG9yIiwiZW5hYmxlVmFsaWRhdGlvbkFkZCIsInBvcHVwV2l0aEltYWdlIiwiX3BvcHVwSW1hZ2VJbWciLCJfcG9wdXBJbWFnZVRpdGxlIiwidXNlckluZm8iLCJfYWJvdXQiLCJfYXZhdGFyIiwic2V0VXNlckluZm8iLCJzZXRVc2VyQXZhdGFyIiwiYWxsIiwidXNlckluZm9BcGkiLCJpdGVtc0FwaSIsImNvbnNvbGUiLCJsb2ciLCJyZXZlcnNlIiwiY2F0Y2giLCJlcnIiLCJwb3B1cERlbGV0ZUNhcmQiLCJfYnV0dG9uIiwiaGFuZGxlU3VibWl0IiwiX2hhbmRsZVN1Ym1pdCIsInBvcHVwRWRpdEZvcm0iLCJpbnB1dFZhbHVlcyIsImZpbmFsbHkiLCJwb3B1cEVkaXRBdmF0YXJGb3JtIiwicG9wdXBBZGRGb3JtIiwicGljdHVyZVRpdGxlIiwicGljdHVyZUxpbmsiLCJuZXdJdGVtIiwibmV3Q2FyZCIsIkNhcmQiLCJjYXJkIl0sInNvdXJjZVJvb3QiOiIifQ==