(()=>{"use strict";const t=class{constructor(t,e,s,i,n,r,o){this._name=t.name,this._link=t.link,this._userId=e._id,this._ownerId=t.owner._id,this._cardId=t._id,this._template=s,this._handleCardClick=i,this._deleteCard=n,this._likeCard=r,this._dislikeCard=o,this._likeQuantity=t.likes}getTemplateCard=()=>(this._card=document.querySelector(this._template).content.querySelector(".elements__element").cloneNode(!0),this._like=this._card.querySelector(".like__vector"),this._likeQuantityCard=this._card.querySelector(".like__quantity"),this._title=this._card.querySelector(".description__title"),this._image=this._card.querySelector(".element__image"),this._delete=this._card.querySelector(".element__del"),this._fillCard(),this._setEventHandlers(),this._card);_addLikeCard=()=>{this._likeCard(this,this._cardId)};likeElement(t){this._likeQuantityCard.textContent=t.likes.length,this._likeQuantity=t.likes,this._like.classList.add(".like__vector_active")}_removeLikeCard=()=>{this._dislikeCard(this,this._cardId)};dislikeElement(t){this._like.classList.remove(".like__vector_active"),this._likeQuantityCard.textContent=t.likes.length,this._likeQuantity=t.likes}_isLike=()=>this._likeQuantity.find((t=>t._id===this._userId));_isYourCard(){return this._ownerId===this._userId}_likeCardForUser(){this._isLike()?this._removeLikeCard():this._addLikeCard()}deleteCardElement(){this._delete.closest(".element").remove()}_setEventHandlers=()=>{this._delete.addEventListener("click",(()=>this._deleteCard(this,this._cardId))),this._like.addEventListener("click",(()=>this._likeCardForUser())),this._image.addEventListener("click",(()=>this._handleCardClick(this._name,this._link)))};_fillCard=()=>{this._isLike()?this._like.classList.add("like__vector_active"):this._like.classList.remove("like__vector_active"),!1===this._isYourCard()&&this._card.querySelector(".element__del").remove(),this._likeQuantityCard.textContent=this._likeQuantity.length,this._image.src=this._link,this._image.alt=this._name,this._title.textContent=this._name}},e=class{constructor(t,e){this._formElement=t,this._config=e}resetValidation(){this._toggleButtonState(),this._inputList.forEach((t=>{this._hideInputError(t)}))}_showInputError=t=>{const e=this._formElement.querySelector(`.${t.id}-error`);e.classList.add(this._config.errorClass),e.textContent=t.validationMessage,t.classList.add(this._config.inputErrorClass)};_hideInputError=t=>{const e=this._formElement.querySelector(`.${t.id}-error`);e.classList.remove(this._config.errorClass),e.textContent="",t.classList.remove(this._config.inputErrorClass)};_checkInputValidity(t){t.validity.valid?this._hideInputError(t):this._showInputError(t)}_hasInvalidInput(){return this._inputList.some((t=>!t.validity.valid))}_toggleButtonState(){this._hasInvalidInput(this._inputList)?(this._buttonElement.classList.remove(this._config.activeButtonClass),this._buttonElement.classList.add(this._config.inactiveButtonClass),this._buttonElement.disabled=!0):(this._buttonElement.classList.add(this._config.activeButtonClass),this._buttonElement.classList.remove(this._config.inactiveButtonClass),this._buttonElement.disabled=!1)}_setEventListeners(){this._inputList=Array.from(this._formElement.querySelectorAll(this._config.inputSelector)),this._buttonElement=this._formElement.querySelector(this._config.submitButtonSelector),this._toggleButtonState(),this._inputList.forEach((t=>{t.addEventListener("input",(()=>{this._checkInputValidity(t),this._toggleButtonState()}))}))}enableValidation(){this._setEventListeners()}};class s{constructor({items:t,renderer:e},s){this._initialArray=t,this._renderer=e,this._container=document.querySelector(s)}renderItems(){this._initialArray.forEach((t=>{const e=this._renderer(t);this.addItem(e)}))}addItem(t){this._container.prepend(t)}}class i{constructor(t){this._popup=document.querySelector(t),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(t){"Escape"==t.code&&this.close()}setEventListeners(){this._popup.querySelector(".popup__close").addEventListener("click",(()=>{this.close()})),this._popup.addEventListener("mousedown",(t=>{t.currentTarget===t.target&&this.close()}))}}class n extends i{constructor(t,e){super(t),this._handleFormSubmit=e,this._form=this._popup.querySelector(".popup__form"),this._inputList=Array.from(this._form.querySelectorAll(".popup__input")),this._buttonSubmit=this._popup.querySelector(".popup__button-submit")}_getInputValues(){return this._formValues={},this._inputList.forEach((t=>{this._formValues[t.name]=t.value})),this._formValues}renameButton(){this._buttonSubmit.textContent="Сохранение..."}close(){super.close(),this._form.reset()}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(t=>{t.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}}const r={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button-submit",activeButtonClass:"popup__button-submit_valid",inactiveButtonClass:"popup__button-submit_invalid",inputErrorClass:"popup__input_type_error",errorClass:"popup__input-error_visible"},o=document.querySelector(".popup_type_edit-profile"),a=o.querySelector("#editForm"),l=document.querySelector(".info__edit-button"),_=(document.querySelector(".info__title"),document.querySelector(".info__subtitle"),o.querySelector(".popup__input_type_name")),h=o.querySelector(".popup__input_type_job"),c=document.querySelector(".popup_type_edit-avatar").querySelector("#editAvatar"),d=document.querySelector(".popup_type_add-card").querySelector("#addForm"),u=document.querySelector(".profile__add-button"),p=document.querySelector(".profile__avatar-edit");let m;const v=new class{constructor(t,e){this._basePath=t,this._token=e}_getHeaders(){return{"Content-Type":"application/json",authorization:this._token}}_getJson(t){return t.ok?t.json():Promise.reject(`Ошибка: ${t.status}`)}getUserInfo(){return fetch(`${this._basePath}/users/me`,{headers:this._getHeaders()}).then(this._getJson)}getCards(){return fetch(`${this._basePath}/cards`,{headers:this._getHeaders()}).then(this._getJson)}createCard(t){return fetch(`${this._basePath}/cards`,{method:"POST",headers:this._getHeaders(),body:JSON.stringify({name:t.name,link:t.link})}).then(this._getJson)}setEditUserInfo(t){return fetch(`${this._basePath}/users/me`,{method:"PATCH",headers:this._getHeaders(),body:JSON.stringify({name:t.name,about:t.job})}).then(this._getJson)}deleteCardApi(t){return fetch(`${this._basePath}/cards/${t}`,{method:"DELETE",headers:this._getHeaders()}).then(this._getJson)}setEditAvatar(t){return fetch(`${this._basePath}/users/me/avatar`,{method:"PATCH",headers:this._getHeaders(),body:JSON.stringify({avatar:t.avatar})}).then(this._getJson)}addLike(t){return fetch(`${this._basePath}/cards/${t}/likes`,{method:"PUT",headers:this._getHeaders()}).then(this._getJson)}deleteLike(t){return fetch(`${this._basePath}/cards/${t}/likes`,{method:"DELETE",headers:this._getHeaders()}).then(this._getJson)}}("https://mesto.nomoreparties.co/v1/cohort-61","3886a799-4854-4a3c-8a86-4cfa412e7d56"),g=new class extends i{constructor(t){super(t),this._popupImageImg=this._popup.querySelector(".popup__img"),this._popupImageTitle=this._popup.querySelector(".popup__img-title")}open(t,e){super.open(),this._popupImageImg.src=e,this._popupImageImg.alt=t,this._popupImageTitle.textContent=t}close(){super.close(),this._popupImageImg.src="",this._popupImageImg.alt="",this._popupImageTitle.textContent=""}}(".popup_type_img");g.setEventListeners();const f=new n(".popup_type_edit-profile",(function(t){const{_id:e,avatar:s}=E.getUserInfo();f.renameButton(),v.setEditUserInfo(t).then((()=>{E.setUserInfo(t.name,t.job,e,s)})).catch((t=>{console.log(t)})).finally((()=>{f.close()}))}));f.setEventListeners(),l.addEventListener("click",(()=>{const{user:t,about:e}=E.getUserInfo();_.value=t,h.value=e,L.resetValidation(),f.open()}));const y=new n(".popup_type_add-card",(function(t){const e=t.pictureTitle,s=t.pictureLink;y.renameButton(),v.createCard({name:e,link:s}).then((t=>{const e=k(t);m.addItem(e)})).catch((t=>{console.log(t)})).finally((()=>{y.close()}))}));function k(e){return new t(e,E.getUserInfo(),"#element-template",b,I,U,x).getTemplateCard()}y.setEventListeners(),u.addEventListener("click",(()=>{C.resetValidation(),y.open()}));const E=new class{constructor({name:t,about:e,avatar:s}){this._name=document.querySelector(t),this._about=document.querySelector(e),this._avatar=document.querySelector(s)}getUserInfo(){return{user:this._name.textContent,about:this._about.textContent,_id:this._id,avatar:this._avatar.src}}setUserInfo(t,e,s,i){this._name.textContent=t,this._about.textContent=e,this._id=s,this._avatar.src=i}setUserAvatar(t){this._avatar.src=t}}({name:".info__title",about:".info__subtitle",avatar:".profile__avatar"});function b(t,e){g.open(t,e)}new e(a,r).enableValidation(a);const C=new e(d,r);C.enableValidation(d);const L=new e(a,r);L.enableValidation(),v.getCards().then((t=>{console.log(t),m=new s({items:t.reverse(),renderer:k},".elements"),m.renderItems()})).catch((t=>{console.log(t)})),v.getUserInfo().then((t=>{console.log(t),E.setUserInfo(t.name,t.about,t._id,t.avatar),E.setUserAvatar(t.avatar)})).catch((t=>{console.log(t)}));const S=new class extends i{constructor(t){super(t),this._button=this._popup.querySelector(".popup__button-submit")}open(t){super.open(),this._handleSubmit=t}setEventListeners(){super.setEventListeners(),this._button.addEventListener("click",(t=>{t.preventDefault(),this._handleSubmit()}))}}(".popup_type_del");function I(t,e){S.open((()=>{v.deleteCardApi(e).then((()=>{t.deleteCardElement(),S.close()})).catch((t=>{console.log(t)}))}))}S.setEventListeners();const q=new e(c,r);q.enableValidation();const w=new n(".popup_type_edit-avatar",(function(t){w.renameButton(),v.setEditAvatar(t).then((()=>{E.setUserAvatar(t.avatar)})).catch((t=>{console.log(t)})).finally((()=>{w.close()}))}));function U(t,e){v.addLike(e).then((e=>{t.likeElement(e)})).catch((t=>{console.log(t)}))}function x(t,e){v.deleteLike(e).then((e=>{t.dislikeElement(e)})).catch((t=>{console.log(t)}))}w.setEventListeners(),p.addEventListener("click",(()=>{q.resetValidation(),w.open()}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguZjc1NTQxMTA2ZGM4MTE0YzIyNDUuanMiLCJtYXBwaW5ncyI6Im1CQW1IQSxRQW5IQSxNQUNFQSxZQUNFQyxFQUNBQyxFQUNBQyxFQUNBQyxFQUNBQyxFQUNBQyxFQUNBQyxHQUVBQyxLQUFLQyxNQUFRUixFQUFLUyxLQUNsQkYsS0FBS0csTUFBUVYsRUFBS1csS0FDbEJKLEtBQUtLLFFBQVVYLEVBQUtZLElBQ3BCTixLQUFLTyxTQUFXZCxFQUFLZSxNQUFNRixJQUMzQk4sS0FBS1MsUUFBVWhCLEVBQUthLElBQ3BCTixLQUFLVSxVQUFZZixFQUNqQkssS0FBS1csaUJBQW1CZixFQUN4QkksS0FBS1ksWUFBY2YsRUFDbkJHLEtBQUthLFVBQVlmLEVBQ2pCRSxLQUFLYyxhQUFlZixFQUNwQkMsS0FBS2UsY0FBZ0J0QixFQUFLdUIsS0FDNUIsQ0FFQUMsZ0JBQWtCLEtBQ2hCakIsS0FBS2tCLE1BQVFDLFNBQ1ZDLGNBQWNwQixLQUFLVSxXQUNuQlcsUUFBUUQsY0FBYyxzQkFDdEJFLFdBQVUsR0FDYnRCLEtBQUt1QixNQUFRdkIsS0FBS2tCLE1BQU1FLGNBQWMsaUJBQ3RDcEIsS0FBS3dCLGtCQUFvQnhCLEtBQUtrQixNQUFNRSxjQUFjLG1CQUNsRHBCLEtBQUt5QixPQUFTekIsS0FBS2tCLE1BQU1FLGNBQWMsdUJBQ3ZDcEIsS0FBSzBCLE9BQVMxQixLQUFLa0IsTUFBTUUsY0FBYyxtQkFDdkNwQixLQUFLMkIsUUFBVTNCLEtBQUtrQixNQUFNRSxjQUFjLGlCQUV4Q3BCLEtBQUs0QixZQUNMNUIsS0FBSzZCLG9CQUVFN0IsS0FBS2tCLE9BR2RZLGFBQWUsS0FDYjlCLEtBQUthLFVBQVViLEtBQU1BLEtBQUtTLFFBQVEsRUFHcENzQixZQUFZQyxHQUNWaEMsS0FBS3dCLGtCQUFrQlMsWUFBY0QsRUFBU2hCLE1BQU1rQixPQUNwRGxDLEtBQUtlLGNBQWdCaUIsRUFBU2hCLE1BQzlCaEIsS0FBS3VCLE1BQU1ZLFVBQVVDLElBQUksdUJBQzNCLENBRUFDLGdCQUFrQixLQUNoQnJDLEtBQUtjLGFBQWFkLEtBQU1BLEtBQUtTLFFBQVEsRUFHdkM2QixlQUFlTixHQUNiaEMsS0FBS3VCLE1BQU1ZLFVBQVVJLE9BQU8sd0JBQzVCdkMsS0FBS3dCLGtCQUFrQlMsWUFBY0QsRUFBU2hCLE1BQU1rQixPQUNwRGxDLEtBQUtlLGNBQWdCaUIsRUFBU2hCLEtBQ2hDLENBRUF3QixRQUFVLElBQ0R4QyxLQUFLZSxjQUFjMEIsTUFDdkJDLEdBQWNBLEVBQVVwQyxNQUFRTixLQUFLSyxVQUkxQ3NDLGNBQ0UsT0FBSTNDLEtBQUtPLFdBQWFQLEtBQUtLLE9BSzdCLENBRUF1QyxtQkFDTTVDLEtBQUt3QyxVQUNQeEMsS0FBS3FDLGtCQUVMckMsS0FBSzhCLGNBRVQsQ0FFQWUsb0JBQ0U3QyxLQUFLMkIsUUFBUW1CLFFBQVEsWUFBWVAsUUFDbkMsQ0FFQVYsa0JBQW9CLEtBQ2xCN0IsS0FBSzJCLFFBQVFvQixpQkFBaUIsU0FBUyxJQUNyQy9DLEtBQUtZLFlBQVlaLEtBQU1BLEtBQUtTLFdBRTlCVCxLQUFLdUIsTUFBTXdCLGlCQUFpQixTQUFTLElBQU0vQyxLQUFLNEMscUJBQ2hENUMsS0FBSzBCLE9BQU9xQixpQkFBaUIsU0FBUyxJQUNwQy9DLEtBQUtXLGlCQUFpQlgsS0FBS0MsTUFBT0QsS0FBS0csUUFDeEMsRUFHSHlCLFVBQVksS0FDTjVCLEtBQUt3QyxVQUNQeEMsS0FBS3VCLE1BQU1ZLFVBQVVDLElBQUksdUJBRXpCcEMsS0FBS3VCLE1BQU1ZLFVBQVVJLE9BQU8sd0JBR0gsSUFBdkJ2QyxLQUFLMkMsZUFDZTNDLEtBQUtrQixNQUFNRSxjQUFjLGlCQUNqQ21CLFNBR2hCdkMsS0FBS3dCLGtCQUFrQlMsWUFBY2pDLEtBQUtlLGNBQWNtQixPQUN4RGxDLEtBQUswQixPQUFPc0IsSUFBTWhELEtBQUtHLE1BQ3ZCSCxLQUFLMEIsT0FBT3VCLElBQU1qRCxLQUFLQyxNQUN2QkQsS0FBS3lCLE9BQU9RLFlBQWNqQyxLQUFLQyxLQUFLLEdDaEN4QyxFQS9FQSxNQUNFVCxZQUFZMEQsRUFBYUMsR0FDdkJuRCxLQUFLb0QsYUFBZUYsRUFDcEJsRCxLQUFLcUQsUUFBVUYsQ0FDakIsQ0FDQUcsa0JBQ0V0RCxLQUFLdUQscUJBQ0x2RCxLQUFLd0QsV0FBV0MsU0FBU0MsSUFDdkIxRCxLQUFLMkQsZ0JBQWdCRCxFQUFhLEdBRXRDLENBRUFFLGdCQUFtQkYsSUFDakIsTUFBTUcsRUFBZTdELEtBQUtvRCxhQUFhaEMsY0FDcEMsSUFBR3NDLEVBQWFJLFlBR25CRCxFQUFhMUIsVUFBVUMsSUFBSXBDLEtBQUtxRCxRQUFRVSxZQUN4Q0YsRUFBYTVCLFlBQWN5QixFQUFhTSxrQkFDeENOLEVBQWF2QixVQUFVQyxJQUFJcEMsS0FBS3FELFFBQVFZLGdCQUFnQixFQUcxRE4sZ0JBQW1CRCxJQUNqQixNQUFNRyxFQUFlN0QsS0FBS29ELGFBQWFoQyxjQUNwQyxJQUFHc0MsRUFBYUksWUFHbkJELEVBQWExQixVQUFVSSxPQUFPdkMsS0FBS3FELFFBQVFVLFlBQzNDRixFQUFhNUIsWUFBYyxHQUMzQnlCLEVBQWF2QixVQUFVSSxPQUFPdkMsS0FBS3FELFFBQVFZLGdCQUFnQixFQUc3REMsb0JBQW9CUixHQUNkQSxFQUFhUyxTQUFTQyxNQUN4QnBFLEtBQUsyRCxnQkFBZ0JELEdBRXJCMUQsS0FBSzRELGdCQUFnQkYsRUFFekIsQ0FFQVcsbUJBQ0UsT0FBT3JFLEtBQUt3RCxXQUFXYyxNQUFNWixJQUFrQkEsRUFBYVMsU0FBU0MsT0FDdkUsQ0FFQWIscUJBQ012RCxLQUFLcUUsaUJBQWlCckUsS0FBS3dELGFBQzdCeEQsS0FBS3VFLGVBQWVwQyxVQUFVSSxPQUFPdkMsS0FBS3FELFFBQVFtQixtQkFDbER4RSxLQUFLdUUsZUFBZXBDLFVBQVVDLElBQUlwQyxLQUFLcUQsUUFBUW9CLHFCQUMvQ3pFLEtBQUt1RSxlQUFlRyxVQUFXLElBRS9CMUUsS0FBS3VFLGVBQWVwQyxVQUFVQyxJQUFJcEMsS0FBS3FELFFBQVFtQixtQkFDL0N4RSxLQUFLdUUsZUFBZXBDLFVBQVVJLE9BQU92QyxLQUFLcUQsUUFBUW9CLHFCQUNsRHpFLEtBQUt1RSxlQUFlRyxVQUFXLEVBRW5DLENBRUFDLHFCQUNFM0UsS0FBS3dELFdBQWFvQixNQUFNQyxLQUN0QjdFLEtBQUtvRCxhQUFhMEIsaUJBQWlCOUUsS0FBS3FELFFBQVEwQixnQkFFbEQvRSxLQUFLdUUsZUFBaUJ2RSxLQUFLb0QsYUFBYWhDLGNBQ3RDcEIsS0FBS3FELFFBQVEyQixzQkFHZmhGLEtBQUt1RCxxQkFFTHZELEtBQUt3RCxXQUFXQyxTQUFTQyxJQUN2QkEsRUFBYVgsaUJBQWlCLFNBQVMsS0FDckMvQyxLQUFLa0Usb0JBQW9CUixHQUN6QjFELEtBQUt1RCxvQkFBb0IsR0FDekIsR0FFTixDQUVBMEIsbUJBQ0VqRixLQUFLMkUsb0JBQ1AsR0M1RWEsTUFBTU8sRUFDbkIxRixhQUFZLE1BQUUyRixFQUFLLFNBQUVDLEdBQVlDLEdBQy9CckYsS0FBS3NGLGNBQWdCSCxFQUNyQm5GLEtBQUt1RixVQUFZSCxFQUVqQnBGLEtBQUt3RixXQUFhckUsU0FBU0MsY0FBY2lFLEVBQzNDLENBQ0FJLGNBQ0V6RixLQUFLc0YsY0FBYzdCLFNBQVNoRSxJQUMxQixNQUFNaUcsRUFBYTFGLEtBQUt1RixVQUFVOUYsR0FDbENPLEtBQUsyRixRQUFRRCxFQUFXLEdBRTVCLENBRUFDLFFBQVFDLEdBQ041RixLQUFLd0YsV0FBV0ssUUFBUUQsRUFDMUIsRUNoQmEsTUFBTUUsRUFDbkJ0RyxZQUFZdUcsR0FDVi9GLEtBQUtnRyxPQUFTN0UsU0FBU0MsY0FBYzJFLEdBQ3JDL0YsS0FBS2lHLGdCQUFrQmpHLEtBQUtpRyxnQkFBZ0JDLEtBQUtsRyxLQUNuRCxDQUVBbUcsT0FDRW5HLEtBQUtnRyxPQUFPN0QsVUFBVUMsSUFBSSxnQkFDMUJqQixTQUFTNEIsaUJBQWlCLFVBQVcvQyxLQUFLaUcsZ0JBQzVDLENBRUFHLFFBQ0VwRyxLQUFLZ0csT0FBTzdELFVBQVVJLE9BQU8sZ0JBQzdCcEIsU0FBU2tGLG9CQUFvQixVQUFXckcsS0FBS2lHLGdCQUMvQyxDQUVBQSxnQkFBZ0JLLEdBQ0UsVUFBWkEsRUFBSUMsTUFDTnZHLEtBQUtvRyxPQUVULENBRUFJLG9CQUNzQnhHLEtBQUtnRyxPQUFPNUUsY0FBYyxpQkFDbEMyQixpQkFBaUIsU0FBUyxLQUNwQy9DLEtBQUtvRyxPQUFPLElBR2RwRyxLQUFLZ0csT0FBT2pELGlCQUFpQixhQUFjdUQsSUFDckNBLEVBQUlHLGdCQUFrQkgsRUFBSUksUUFDNUIxRyxLQUFLb0csT0FDUCxHQUVKLEVDL0JhLE1BQU1PLFVBQXNCYixFQUN6Q3RHLFlBQVl1RyxFQUFPYSxHQUNqQkMsTUFBTWQsR0FDTi9GLEtBQUs4RyxrQkFBb0JGLEVBQ3pCNUcsS0FBSytHLE1BQVEvRyxLQUFLZ0csT0FBTzVFLGNBQWMsZ0JBQ3ZDcEIsS0FBS3dELFdBQWFvQixNQUFNQyxLQUFLN0UsS0FBSytHLE1BQU1qQyxpQkFBaUIsa0JBQ3pEOUUsS0FBS2dILGNBQWdCaEgsS0FBS2dHLE9BQU81RSxjQUFjLHdCQUNqRCxDQUVBNkYsa0JBS0UsT0FKQWpILEtBQUtrSCxZQUFjLENBQUMsRUFDcEJsSCxLQUFLd0QsV0FBV0MsU0FBUzBELElBQ3ZCbkgsS0FBS2tILFlBQVlDLEVBQU1qSCxNQUFRaUgsRUFBTUMsS0FBSyxJQUVyQ3BILEtBQUtrSCxXQUNkLENBRUFHLGVBQ0VySCxLQUFLZ0gsY0FBYy9FLFlBQWMsZUFDbkMsQ0FFQW1FLFFBQ0VTLE1BQU1ULFFBQ05wRyxLQUFLK0csTUFBTU8sT0FDYixDQUVBZCxvQkFDRUssTUFBTUwsb0JBQ054RyxLQUFLK0csTUFBTWhFLGlCQUFpQixVQUFXdUQsSUFDckNBLEVBQUlpQixpQkFDSnZILEtBQUs4RyxrQkFBa0I5RyxLQUFLaUgsa0JBQWtCLEdBRWxELEVDb0RGLE1DdEZNTyxFQUFtQixDQUN2QkMsYUFBYyxlQUNkMUMsY0FBZSxnQkFDZkMscUJBQXNCLHdCQUN0QlIsa0JBQW1CLDZCQUNuQkMsb0JBQXFCLCtCQUNyQlIsZ0JBQWlCLDBCQUNqQkYsV0FBWSw4QkFLUjJELEVBQWV2RyxTQUFTQyxjQUFjLDRCQUN0Q3VHLEVBQWtCRCxFQUFhdEcsY0FBYyxhQUM3Q3dHLEVBQWtCekcsU0FBU0MsY0FBYyxzQkFJekN5RyxHQUhZMUcsU0FBU0MsY0FBYyxnQkFDcEJELFNBQVNDLGNBQWMsbUJBRTFCc0csRUFBYXRHLGNBQWMsNEJBQ3ZDMEcsRUFBV0osRUFBYXRHLGNBQWMsMEJBR3RDMkcsRUFEa0I1RyxTQUFTQyxjQUFjLDJCQUNSQSxjQUFjLGVBRy9DNEcsRUFEWTdHLFNBQVNDLGNBQWMsd0JBQ1JBLGNBQWMsWUFDekM2RyxFQUFpQjlHLFNBQVNDLGNBQWMsd0JBRXhDOEcsRUFBbUIvRyxTQUFTQyxjQUFjLHlCQ05oRCxJQUFJK0csRUFFSixNQUFNQyxFQUFNLElGeEJaLE1BQ0U1SSxZQUFZNkksRUFBVUMsR0FDcEJ0SSxLQUFLdUksVUFBWUYsRUFDakJySSxLQUFLd0ksT0FBU0YsQ0FDaEIsQ0FFQUcsY0FDRSxNQUFPLENBQ0wsZUFBZ0IsbUJBQ2hCQyxjQUFlMUksS0FBS3dJLE9BRXhCLENBRUFHLFNBQVNDLEdBQ1AsT0FBSUEsRUFBSUMsR0FDQ0QsRUFBSUUsT0FFTkMsUUFBUUMsT0FBUSxXQUFVSixFQUFJSyxTQUN2QyxDQUVBQyxjQUNFLE9BQU9DLE1BQU8sR0FBRW5KLEtBQUt1SSxxQkFBc0IsQ0FDekNhLFFBQVNwSixLQUFLeUksZ0JBQ2JZLEtBQUtySixLQUFLMkksU0FDZixDQUVBVyxXQUNFLE9BQU9ILE1BQU8sR0FBRW5KLEtBQUt1SSxrQkFBbUIsQ0FDdENhLFFBQVNwSixLQUFLeUksZ0JBQ2JZLEtBQUtySixLQUFLMkksU0FDZixDQUVBWSxXQUFXOUosR0FDVCxPQUFPMEosTUFBTyxHQUFFbkosS0FBS3VJLGtCQUFtQixDQUN0Q2lCLE9BQVEsT0FDUkosUUFBU3BKLEtBQUt5SSxjQUNkZ0IsS0FBTUMsS0FBS0MsVUFBVSxDQUNuQnpKLEtBQU1ULEVBQUtTLEtBQ1hFLEtBQU1YLEVBQUtXLFNBRVppSixLQUFLckosS0FBSzJJLFNBQ2YsQ0FFQWlCLGdCQUFnQkMsR0FDZCxPQUFPVixNQUFPLEdBQUVuSixLQUFLdUkscUJBQXNCLENBQ3pDaUIsT0FBUSxRQUNSSixRQUFTcEosS0FBS3lJLGNBQ2RnQixLQUFNQyxLQUFLQyxVQUFVLENBQ25CekosS0FBTTJKLEVBQUszSixLQUNYNEosTUFBT0QsRUFBS0UsUUFFYlYsS0FBS3JKLEtBQUsySSxTQUNmLENBRUFxQixjQUFjQyxHQUNaLE9BQU9kLE1BQU8sR0FBRW5KLEtBQUt1SSxtQkFBbUIwQixJQUFVLENBQ2hEVCxPQUFRLFNBQ1JKLFFBQVNwSixLQUFLeUksZ0JBQ2JZLEtBQUtySixLQUFLMkksU0FDZixDQUVBdUIsY0FBY0wsR0FDWixPQUFPVixNQUFPLEdBQUVuSixLQUFLdUksNEJBQTZCLENBQ2hEaUIsT0FBUSxRQUNSSixRQUFTcEosS0FBS3lJLGNBQ2RnQixLQUFNQyxLQUFLQyxVQUFVLENBQ25CUSxPQUFRTixFQUFLTSxXQUVkZCxLQUFLckosS0FBSzJJLFNBQ2YsQ0FFQXlCLFFBQVFILEdBQ04sT0FBT2QsTUFBTyxHQUFFbkosS0FBS3VJLG1CQUFtQjBCLFVBQWdCLENBQ3REVCxPQUFRLE1BQ1JKLFFBQVNwSixLQUFLeUksZ0JBQ2JZLEtBQUtySixLQUFLMkksU0FDZixDQUVBMEIsV0FBV0osR0FDVCxPQUFPZCxNQUFPLEdBQUVuSixLQUFLdUksbUJBQW1CMEIsVUFBZ0IsQ0FDdERULE9BQVEsU0FDUkosUUFBU3BKLEtBQUt5SSxnQkFDYlksS0FBS3JKLEtBQUsySSxTQUNmLEdFMURBLDhDQUNBLHdDQUdJMkIsRUFBaUIsSUMzQlIsY0FBNkJ4RSxFQUMxQ3RHLFlBQVl1RyxHQUNWYyxNQUFNZCxHQUNOL0YsS0FBS3VLLGVBQWlCdkssS0FBS2dHLE9BQU81RSxjQUFjLGVBQ2hEcEIsS0FBS3dLLGlCQUFtQnhLLEtBQUtnRyxPQUFPNUUsY0FBYyxvQkFDcEQsQ0FFQStFLEtBQUtqRyxFQUFNRSxHQUNUeUcsTUFBTVYsT0FDTm5HLEtBQUt1SyxlQUFldkgsSUFBTTVDLEVBQzFCSixLQUFLdUssZUFBZXRILElBQU0vQyxFQUMxQkYsS0FBS3dLLGlCQUFpQnZJLFlBQWMvQixDQUN0QyxDQUVBa0csUUFDRVMsTUFBTVQsUUFDTnBHLEtBQUt1SyxlQUFldkgsSUFBTSxHQUMxQmhELEtBQUt1SyxlQUFldEgsSUFBTSxHQUMxQmpELEtBQUt3SyxpQkFBaUJ2SSxZQUFjLEVBQ3RDLEdEUXdDLG1CQUMxQ3FJLEVBQWU5RCxvQkFFZixNQUFNaUUsRUFBZ0IsSUFBSTlELEVBQ3hCLDRCQWFGLFNBQTJCK0QsR0FDekIsTUFBTSxJQUFFcEssRUFBRyxPQUFFNkosR0FBV1EsRUFBU3pCLGNBQ2pDdUIsRUFBY3BELGVBQ2RlLEVBQ0d3QixnQkFBZ0JjLEdBQ2hCckIsTUFBSyxLQUNKc0IsRUFBU0MsWUFBWUYsRUFBWXhLLEtBQU13SyxFQUFZWCxJQUFLekosRUFBSzZKLEVBQU8sSUFFckVVLE9BQU9DLElBQ05DLFFBQVFDLElBQUlGLEVBQUksSUFFakJHLFNBQVEsS0FDUFIsRUFBY3JFLE9BQU8sR0FFM0IsSUF4QkFxRSxFQUFjakUsb0JBRWRvQixFQUFnQjdFLGlCQUFpQixTQUFTLEtBQ3hDLE1BQU0sS0FBRXJELEVBQUksTUFBRW9LLEdBQVVhLEVBQVN6QixjQUNqQ3JCLEVBQVVULE1BQVExSCxFQUNsQm9JLEVBQVNWLE1BQVEwQyxFQUNqQm9CLEVBQXFCNUgsa0JBQ3JCbUgsRUFBY3RFLE1BQU0sSUFtQnRCLE1BQU1nRixFQUFlLElBQUl4RSxFQUFjLHdCQUd2QyxTQUF3QitELEdBQ3RCLE1BQU14SyxFQUFPd0ssRUFBWVUsYUFDbkJoTCxFQUFPc0ssRUFBWVcsWUFDekJGLEVBQWE5RCxlQUViZSxFQUNHbUIsV0FBVyxDQUFFckosT0FBTUUsU0FDbkJpSixNQUFNaUMsSUFDTCxNQUFNQyxFQUFVaEMsRUFBVytCLEdBQzNCbkQsRUFBWXhDLFFBQVE0RixFQUFRLElBRTdCVixPQUFPQyxJQUNOQyxRQUFRQyxJQUFJRixFQUFJLElBRWpCRyxTQUFRLEtBQ1BFLEVBQWEvRSxPQUFPLEdBRTFCLElBT0EsU0FBU21ELEVBQVc5SixHQVVsQixPQVRhLElBQUkrTCxFQUNmL0wsRUFDQWtMLEVBQVN6QixjQUNULG9CQUNBdEosRUFDQUMsRUFDQUMsRUFDQUMsR0FDQWtCLGlCQUVKLENBckNBa0ssRUFBYTNFLG9CQXFCYnlCLEVBQWVsRixpQkFBaUIsU0FBUyxLQUN2QzBJLEVBQW9Cbkksa0JBQ3BCNkgsRUFBYWhGLE1BQU0sSUFnQnJCLE1BQU13RSxFQUFXLElFdEdGLE1BQ2JuTCxhQUFZLEtBQUVVLEVBQUksTUFBRTRKLEVBQUssT0FBRUssSUFDekJuSyxLQUFLQyxNQUFRa0IsU0FBU0MsY0FBY2xCLEdBQ3BDRixLQUFLMEwsT0FBU3ZLLFNBQVNDLGNBQWMwSSxHQUNyQzlKLEtBQUsyTCxRQUFVeEssU0FBU0MsY0FBYytJLEVBQ3hDLENBRUFqQixjQUNFLE1BQU8sQ0FDTHhKLEtBQU1NLEtBQUtDLE1BQU1nQyxZQUNqQjZILE1BQU85SixLQUFLMEwsT0FBT3pKLFlBQ25CM0IsSUFBS04sS0FBS00sSUFDVjZKLE9BQVFuSyxLQUFLMkwsUUFBUTNJLElBRXpCLENBRUE0SCxZQUFZMUssRUFBTTRKLEVBQU94SixFQUFLNkosR0FDNUJuSyxLQUFLQyxNQUFNZ0MsWUFBYy9CLEVBQ3pCRixLQUFLMEwsT0FBT3pKLFlBQWM2SCxFQUMxQjlKLEtBQUtNLElBQU1BLEVBQ1hOLEtBQUsyTCxRQUFRM0ksSUFBTW1ILENBQ3JCLENBRUF5QixjQUFjekIsR0FDWm5LLEtBQUsyTCxRQUFRM0ksSUFBTW1ILENBQ3JCLEdGNkU0QixDQUM1QmpLLEtBQU0sZUFDTjRKLE1BQU8sa0JBQ1BLLE9BQVEscUJBR1YsU0FBU3ZLLEVBQWdCTSxFQUFNRSxHQUM3QmtLLEVBQWVuRSxLQUFLakcsRUFBTUUsRUFDNUIsQ0FFNkIsSUFBSXlMLEVBQy9CbEUsRUFDQUgsR0FFbUJ2QyxpQkFBaUIwQyxHQUV0QyxNQUFNOEQsRUFBc0IsSUFBSUksRUFBYzdELEVBQWdCUixHQUM5RGlFLEVBQW9CeEcsaUJBQWlCK0MsR0FFckMsTUFBTWtELEVBQXVCLElBQUlXLEVBQy9CbEUsRUFDQUgsR0FFRjBELEVBQXFCakcsbUJBRXJCbUQsRUFDR2tCLFdBQ0FELE1BQU15QyxJQUNMZixRQUFRQyxJQUFJYyxHQUNaM0QsRUFBYyxJQUFJakQsRUFDaEIsQ0FDRUMsTUFBTzJHLEVBQVNDLFVBQ2hCM0csU0FBVW1FLEdENUhLLGFDZ0luQnBCLEVBQVkxQyxhQUFhLElBRTFCb0YsT0FBT0MsSUFDTkMsUUFBUUMsSUFBSUYsRUFBSSxJQUdwQjFDLEVBQ0djLGNBQ0FHLE1BQU0yQyxJQUNMakIsUUFBUUMsSUFBSWdCLEdBQ1pyQixFQUFTQyxZQUNQb0IsRUFBWTlMLEtBQ1o4TCxFQUFZbEMsTUFDWmtDLEVBQVkxTCxJQUNaMEwsRUFBWTdCLFFBRWRRLEVBQVNpQixjQUFjSSxFQUFZN0IsT0FBTyxJQUUzQ1UsT0FBT0MsSUFDTkMsUUFBUUMsSUFBSUYsRUFBSSxJQUdwQixNQUFNbUIsRUFBa0IsSUc5SlQsY0FBMkJuRyxFQUN4Q3RHLFlBQVk2RixHQUNWd0IsTUFBTXhCLEdBQ05yRixLQUFLa00sUUFBVWxNLEtBQUtnRyxPQUFPNUUsY0FBYyx3QkFDM0MsQ0FDQStFLEtBQUtnRyxHQUNIdEYsTUFBTVYsT0FDTm5HLEtBQUtvTSxjQUFnQkQsQ0FDdkIsQ0FFQTNGLG9CQUNFSyxNQUFNTCxvQkFDTnhHLEtBQUtrTSxRQUFRbkosaUJBQWlCLFNBQVV1RCxJQUN0Q0EsRUFBSWlCLGlCQUNKdkgsS0FBS29NLGVBQWUsR0FFeEIsR0g4SXVDLG1CQUd6QyxTQUFTdk0sRUFBV3dNLEVBQU0vTCxHQUN4QjJMLEVBQWdCOUYsTUFBSyxLQUNuQmlDLEVBQ0c0QixjQUFjMUosR0FDZCtJLE1BQUssS0FDSmdELEVBQUt4SixvQkFDTG9KLEVBQWdCN0YsT0FBTyxJQUV4QnlFLE9BQU9DLElBQ05DLFFBQVFDLElBQUlGLEVBQUksR0FDaEIsR0FFUixDQWRBbUIsRUFBZ0J6RixvQkFnQmhCLE1BQU04RixFQUFzQixJQUFJVCxFQUFjOUQsRUFBZ0JQLEdBQzlEOEUsRUFBb0JySCxtQkFFcEIsTUFBTXNILEVBQXNCLElBQUk1RixFQUM5QiwyQkFVRixTQUEwQitELEdBQ3hCNkIsRUFBb0JsRixlQUNwQmUsRUFDRzhCLGNBQWNRLEdBQ2RyQixNQUFLLEtBQ0pzQixFQUFTaUIsY0FBY2xCLEVBQVlQLE9BQU8sSUFFM0NVLE9BQU9DLElBQ05DLFFBQVFDLElBQUlGLEVBQUksSUFHakJHLFNBQVEsS0FDUHNCLEVBQW9CbkcsT0FBTyxHQUVqQyxJQUVBLFNBQVN0RyxFQUFTdU0sRUFBTS9MLEdBQ3RCOEgsRUFDR2dDLFFBQVE5SixHQUNSK0ksTUFBTXJILElBQ0xxSyxFQUFLdEssWUFBWUMsRUFBUyxJQUUzQjZJLE9BQU9DLElBQ05DLFFBQVFDLElBQUlGLEVBQUksR0FFdEIsQ0FFQSxTQUFTL0ssRUFBWXNNLEVBQU0vTCxHQUN6QjhILEVBQ0dpQyxXQUFXL0osR0FDWCtJLE1BQU1ySCxJQUNMcUssRUFBSy9KLGVBQWVOLEVBQVMsSUFFOUI2SSxPQUFPQyxJQUNOQyxRQUFRQyxJQUFJRixFQUFJLEdBRXRCLENBM0NBeUIsRUFBb0IvRixvQkFFcEIwQixFQUFpQm5GLGlCQUFpQixTQUFTLEtBQ3pDdUosRUFBb0JoSixrQkFDcEJpSixFQUFvQnBHLE1BQU0sRyIsInNvdXJjZXMiOlsid2VicGFjazovL3ByYWt0aWN1bS8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vcHJha3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9wcmFrdGljdW0vLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3ByYWt0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3ByYWt0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vcHJha3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL3ByYWt0aWN1bS8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vcHJha3RpY3VtLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3ByYWt0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3ByYWt0aWN1bS8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3ByYWt0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEFjay5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjbGFzcyBDYXJkIHtcclxuICBjb25zdHJ1Y3RvcihcclxuICAgIGl0ZW0sXHJcbiAgICB1c2VyLFxyXG4gICAgdGVtcGxhdGUsXHJcbiAgICBoYW5kbGVDYXJkQ2xpY2ssXHJcbiAgICBkZWxldGVDYXJkLFxyXG4gICAgbGlrZUNhcmQsXHJcbiAgICBkaXNsaWtlQ2FyZFxyXG4gICkge1xyXG4gICAgdGhpcy5fbmFtZSA9IGl0ZW0ubmFtZTtcclxuICAgIHRoaXMuX2xpbmsgPSBpdGVtLmxpbms7XHJcbiAgICB0aGlzLl91c2VySWQgPSB1c2VyLl9pZDtcclxuICAgIHRoaXMuX293bmVySWQgPSBpdGVtLm93bmVyLl9pZDtcclxuICAgIHRoaXMuX2NhcmRJZCA9IGl0ZW0uX2lkO1xyXG4gICAgdGhpcy5fdGVtcGxhdGUgPSB0ZW1wbGF0ZTtcclxuICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayA9IGhhbmRsZUNhcmRDbGljaztcclxuICAgIHRoaXMuX2RlbGV0ZUNhcmQgPSBkZWxldGVDYXJkO1xyXG4gICAgdGhpcy5fbGlrZUNhcmQgPSBsaWtlQ2FyZDtcclxuICAgIHRoaXMuX2Rpc2xpa2VDYXJkID0gZGlzbGlrZUNhcmQ7XHJcbiAgICB0aGlzLl9saWtlUXVhbnRpdHkgPSBpdGVtLmxpa2VzO1xyXG4gIH1cclxuXHJcbiAgZ2V0VGVtcGxhdGVDYXJkID0gKCkgPT4ge1xyXG4gICAgdGhpcy5fY2FyZCA9IGRvY3VtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX3RlbXBsYXRlKVxyXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRzX19lbGVtZW50XCIpXHJcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgICB0aGlzLl9saWtlID0gdGhpcy5fY2FyZC5xdWVyeVNlbGVjdG9yKFwiLmxpa2VfX3ZlY3RvclwiKTtcclxuICAgIHRoaXMuX2xpa2VRdWFudGl0eUNhcmQgPSB0aGlzLl9jYXJkLnF1ZXJ5U2VsZWN0b3IoXCIubGlrZV9fcXVhbnRpdHlcIik7XHJcbiAgICB0aGlzLl90aXRsZSA9IHRoaXMuX2NhcmQucXVlcnlTZWxlY3RvcihcIi5kZXNjcmlwdGlvbl9fdGl0bGVcIik7XHJcbiAgICB0aGlzLl9pbWFnZSA9IHRoaXMuX2NhcmQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X19pbWFnZVwiKTtcclxuICAgIHRoaXMuX2RlbGV0ZSA9IHRoaXMuX2NhcmQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X19kZWxcIik7XHJcblxyXG4gICAgdGhpcy5fZmlsbENhcmQoKTtcclxuICAgIHRoaXMuX3NldEV2ZW50SGFuZGxlcnMoKTtcclxuXHJcbiAgICByZXR1cm4gdGhpcy5fY2FyZDtcclxuICB9O1xyXG5cclxuICBfYWRkTGlrZUNhcmQgPSAoKSA9PiB7XHJcbiAgICB0aGlzLl9saWtlQ2FyZCh0aGlzLCB0aGlzLl9jYXJkSWQpO1xyXG4gIH07XHJcblxyXG4gIGxpa2VFbGVtZW50KGNhcmREYXRhKSB7XHJcbiAgICB0aGlzLl9saWtlUXVhbnRpdHlDYXJkLnRleHRDb250ZW50ID0gY2FyZERhdGEubGlrZXMubGVuZ3RoO1xyXG4gICAgdGhpcy5fbGlrZVF1YW50aXR5ID0gY2FyZERhdGEubGlrZXM7XHJcbiAgICB0aGlzLl9saWtlLmNsYXNzTGlzdC5hZGQoXCIubGlrZV9fdmVjdG9yX2FjdGl2ZVwiKTtcclxuICB9XHJcblxyXG4gIF9yZW1vdmVMaWtlQ2FyZCA9ICgpID0+IHtcclxuICAgIHRoaXMuX2Rpc2xpa2VDYXJkKHRoaXMsIHRoaXMuX2NhcmRJZCk7XHJcbiAgfTtcclxuXHJcbiAgZGlzbGlrZUVsZW1lbnQoY2FyZERhdGEpIHtcclxuICAgIHRoaXMuX2xpa2UuY2xhc3NMaXN0LnJlbW92ZShcIi5saWtlX192ZWN0b3JfYWN0aXZlXCIpO1xyXG4gICAgdGhpcy5fbGlrZVF1YW50aXR5Q2FyZC50ZXh0Q29udGVudCA9IGNhcmREYXRhLmxpa2VzLmxlbmd0aDtcclxuICAgIHRoaXMuX2xpa2VRdWFudGl0eSA9IGNhcmREYXRhLmxpa2VzO1xyXG4gIH1cclxuXHJcbiAgX2lzTGlrZSA9ICgpID0+IHtcclxuICAgIHJldHVybiB0aGlzLl9saWtlUXVhbnRpdHkuZmluZChcclxuICAgICAgKGVsZW1lbnRJZCkgPT4gZWxlbWVudElkLl9pZCA9PT0gdGhpcy5fdXNlcklkXHJcbiAgICApO1xyXG4gIH07XHJcblxyXG4gIF9pc1lvdXJDYXJkKCkge1xyXG4gICAgaWYgKHRoaXMuX293bmVySWQgPT09IHRoaXMuX3VzZXJJZCkge1xyXG4gICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9saWtlQ2FyZEZvclVzZXIoKSB7XHJcbiAgICBpZiAodGhpcy5faXNMaWtlKCkpIHtcclxuICAgICAgdGhpcy5fcmVtb3ZlTGlrZUNhcmQoKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2FkZExpa2VDYXJkKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBkZWxldGVDYXJkRWxlbWVudCgpIHtcclxuICAgIHRoaXMuX2RlbGV0ZS5jbG9zZXN0KFwiLmVsZW1lbnRcIikucmVtb3ZlKCk7XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRIYW5kbGVycyA9ICgpID0+IHtcclxuICAgIHRoaXMuX2RlbGV0ZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT5cclxuICAgICAgdGhpcy5fZGVsZXRlQ2FyZCh0aGlzLCB0aGlzLl9jYXJkSWQpXHJcbiAgICApO1xyXG4gICAgdGhpcy5fbGlrZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5fbGlrZUNhcmRGb3JVc2VyKCkpO1xyXG4gICAgdGhpcy5faW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+XHJcbiAgICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayh0aGlzLl9uYW1lLCB0aGlzLl9saW5rKVxyXG4gICAgKTtcclxuICB9O1xyXG5cclxuICBfZmlsbENhcmQgPSAoKSA9PiB7XHJcbiAgICBpZiAodGhpcy5faXNMaWtlKCkpIHtcclxuICAgICAgdGhpcy5fbGlrZS5jbGFzc0xpc3QuYWRkKFwibGlrZV9fdmVjdG9yX2FjdGl2ZVwiKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2xpa2UuY2xhc3NMaXN0LnJlbW92ZShcImxpa2VfX3ZlY3Rvcl9hY3RpdmVcIik7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHRoaXMuX2lzWW91ckNhcmQoKSA9PT0gZmFsc2UpIHtcclxuICAgICAgY29uc3QgZGVsZXRlRWxlbWVudCA9IHRoaXMuX2NhcmQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X19kZWxcIik7XHJcbiAgICAgIGRlbGV0ZUVsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5fbGlrZVF1YW50aXR5Q2FyZC50ZXh0Q29udGVudCA9IHRoaXMuX2xpa2VRdWFudGl0eS5sZW5ndGg7XHJcbiAgICB0aGlzLl9pbWFnZS5zcmMgPSB0aGlzLl9saW5rO1xyXG4gICAgdGhpcy5faW1hZ2UuYWx0ID0gdGhpcy5fbmFtZTtcclxuICAgIHRoaXMuX3RpdGxlLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcclxuICB9O1xyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBDYXJkO1xyXG4iLCJjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICBjb25zdHJ1Y3Rvcihmb3JtRWxlbWVudCwgY29uZmlnKSB7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xyXG4gICAgdGhpcy5fY29uZmlnID0gY29uZmlnO1xyXG4gIH1cclxuICByZXNldFZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBfc2hvd0lucHV0RXJyb3IgPSAoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcclxuICAgICk7XHJcblxyXG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fY29uZmlnLmVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XHJcbiAgfTtcclxuXHJcbiAgX2hpZGVJbnB1dEVycm9yID0gKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXHJcbiAgICApO1xyXG5cclxuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2NvbmZpZy5lcnJvckNsYXNzKTtcclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9jb25maWcuaW5wdXRFcnJvckNsYXNzKTtcclxuICB9O1xyXG5cclxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xyXG4gICAgaWYgKGlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5faW5wdXRMaXN0LnNvbWUoKGlucHV0RWxlbWVudCkgPT4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCk7XHJcbiAgfVxyXG5cclxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XHJcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KHRoaXMuX2lucHV0TGlzdCkpIHtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2NvbmZpZy5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9jb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2NvbmZpZy5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9jb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2lucHV0TGlzdCA9IEFycmF5LmZyb20oXHJcbiAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5fY29uZmlnLmlucHV0U2VsZWN0b3IpXHJcbiAgICApO1xyXG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIHRoaXMuX2NvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3RvclxyXG4gICAgKTtcclxuXHJcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG5cclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XHJcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgRm9ybVZhbGlkYXRvcjtcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XHJcbiAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgc2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX2luaXRpYWxBcnJheSA9IGl0ZW1zO1xyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuXHJcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKTtcclxuICB9XHJcbiAgcmVuZGVySXRlbXMoKSB7XHJcbiAgICB0aGlzLl9pbml0aWFsQXJyYXkuZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG4gICAgICBjb25zdCByZW5kZXJDYXJkID0gdGhpcy5fcmVuZGVyZXIoaXRlbSk7XHJcbiAgICAgIHRoaXMuYWRkSXRlbShyZW5kZXJDYXJkKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgYWRkSXRlbShlbGVtZW50KSB7XHJcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwKSB7XHJcbiAgICB0aGlzLl9wb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXApO1xyXG4gICAgdGhpcy5faGFuZGxlRXNjQ2xvc2UgPSB0aGlzLl9oYW5kbGVFc2NDbG9zZS5iaW5kKHRoaXMpO1xyXG4gIH1cclxuXHJcbiAgb3BlbigpIHtcclxuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5yZW1vdmUoXCJwb3B1cF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlRXNjQ2xvc2UoZXZ0KSB7XHJcbiAgICBpZiAoZXZ0LmNvZGUgPT0gXCJFc2NhcGVcIikge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIGNvbnN0IGJ1dHRvbkNsb3NlID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fY2xvc2VcIik7XHJcbiAgICBidXR0b25DbG9zZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICB0aGlzLl9wb3B1cC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChldnQpID0+IHtcclxuICAgICAgaWYgKGV2dC5jdXJyZW50VGFyZ2V0ID09PSBldnQudGFyZ2V0KSB7XHJcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwLCBoYW5kbGVGb3JtU3VibWl0KSB7XHJcbiAgICBzdXBlcihwb3B1cCk7XHJcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcclxuICAgIHRoaXMuX2Zvcm0gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19mb3JtXCIpO1xyXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbSh0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCIucG9wdXBfX2lucHV0XCIpKTtcclxuICAgIHRoaXMuX2J1dHRvblN1Ym1pdCA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2J1dHRvbi1zdWJtaXRcIik7XHJcbiAgfVxyXG5cclxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICB0aGlzLl9mb3JtVmFsdWVzID0ge307XHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgdGhpcy5fZm9ybVZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gdGhpcy5fZm9ybVZhbHVlcztcclxuICB9XHJcblxyXG4gIHJlbmFtZUJ1dHRvbigpIHtcclxuICAgIHRoaXMuX2J1dHRvblN1Ym1pdC50ZXh0Q29udGVudCA9IFwi0KHQvtGF0YDQsNC90LXQvdC40LUuLi5cIjtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgc3VwZXIuY2xvc2UoKTtcclxuICAgIHRoaXMuX2Zvcm0ucmVzZXQoKTtcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImNsYXNzIEFwaSB7XHJcbiAgY29uc3RydWN0b3IoYmFzZVBhdGgsIHRva2VuKSB7XHJcbiAgICB0aGlzLl9iYXNlUGF0aCA9IGJhc2VQYXRoO1xyXG4gICAgdGhpcy5fdG9rZW4gPSB0b2tlbjtcclxuICB9XHJcblxyXG4gIF9nZXRIZWFkZXJzKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX3Rva2VuLFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIF9nZXRKc29uKHJlcykge1xyXG4gICAgaWYgKHJlcy5vaykge1xyXG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgIH1cclxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChg0J7RiNC40LHQutCwOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlUGF0aH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2dldEhlYWRlcnMoKSxcclxuICAgIH0pLnRoZW4odGhpcy5fZ2V0SnNvbik7XHJcbiAgfVxyXG5cclxuICBnZXRDYXJkcygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlUGF0aH0vY2FyZHNgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2dldEhlYWRlcnMoKSxcclxuICAgIH0pLnRoZW4odGhpcy5fZ2V0SnNvbik7XHJcbiAgfVxyXG5cclxuICBjcmVhdGVDYXJkKGl0ZW0pIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlUGF0aH0vY2FyZHNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2dldEhlYWRlcnMoKSxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWU6IGl0ZW0ubmFtZSxcclxuICAgICAgICBsaW5rOiBpdGVtLmxpbmssXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbih0aGlzLl9nZXRKc29uKTtcclxuICB9XHJcblxyXG4gIHNldEVkaXRVc2VySW5mbyhkYXRhKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVBhdGh9L3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5fZ2V0SGVhZGVycygpLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICAgIGFib3V0OiBkYXRhLmpvYixcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2dldEpzb24pO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlQ2FyZEFwaShjYXJkSWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlUGF0aH0vY2FyZHMvJHtjYXJkSWR9YCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2dldEhlYWRlcnMoKSxcclxuICAgIH0pLnRoZW4odGhpcy5fZ2V0SnNvbik7XHJcbiAgfVxyXG5cclxuICBzZXRFZGl0QXZhdGFyKGRhdGEpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlUGF0aH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5fZ2V0SGVhZGVycygpLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgYXZhdGFyOiBkYXRhLmF2YXRhcixcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2dldEpzb24pO1xyXG4gIH1cclxuXHJcbiAgYWRkTGlrZShjYXJkSWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlUGF0aH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2dldEhlYWRlcnMoKSxcclxuICAgIH0pLnRoZW4odGhpcy5fZ2V0SnNvbik7XHJcbiAgfVxyXG5cclxuICBkZWxldGVMaWtlKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VQYXRofS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5fZ2V0SGVhZGVycygpLFxyXG4gICAgfSkudGhlbih0aGlzLl9nZXRKc29uKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IEFwaTtcclxuIiwiY29uc3QgdmFsaWRhdGlvbkNvbmZpZyA9IHtcclxuICBmb3JtU2VsZWN0b3I6IFwiLnBvcHVwX19mb3JtXCIsXHJcbiAgaW5wdXRTZWxlY3RvcjogXCIucG9wdXBfX2lucHV0XCIsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLnBvcHVwX19idXR0b24tc3VibWl0XCIsXHJcbiAgYWN0aXZlQnV0dG9uQ2xhc3M6IFwicG9wdXBfX2J1dHRvbi1zdWJtaXRfdmFsaWRcIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcInBvcHVwX19idXR0b24tc3VibWl0X2ludmFsaWRcIixcclxuICBpbnB1dEVycm9yQ2xhc3M6IFwicG9wdXBfX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICBlcnJvckNsYXNzOiBcInBvcHVwX19pbnB1dC1lcnJvcl92aXNpYmxlXCIsXHJcbn07XHJcblxyXG5jb25zdCBjYXJkc0NvbnRhaW5lciA9IFwiLmVsZW1lbnRzXCI7XHJcblxyXG5jb25zdCBwb3B1cFByb2ZpbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX3R5cGVfZWRpdC1wcm9maWxlXCIpO1xyXG5jb25zdCBmb3JtRWRpdEVsZW1lbnQgPSBwb3B1cFByb2ZpbGUucXVlcnlTZWxlY3RvcihcIiNlZGl0Rm9ybVwiKTtcclxuY29uc3QgcG9wdXBFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5pbmZvX19lZGl0LWJ1dHRvblwiKTtcclxuY29uc3QgaW5mb1RpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5pbmZvX190aXRsZVwiKTtcclxuY29uc3QgaW5mb1N1YnRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5pbmZvX19zdWJ0aXRsZVwiKTtcclxuXHJcbmNvbnN0IHBvcHVwTmFtZSA9IHBvcHVwUHJvZmlsZS5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19pbnB1dF90eXBlX25hbWVcIik7XHJcbmNvbnN0IHBvcHVwSm9iID0gcG9wdXBQcm9maWxlLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2lucHV0X3R5cGVfam9iXCIpO1xyXG5cclxuY29uc3QgcG9wdXBFZGl0QXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF90eXBlX2VkaXQtYXZhdGFyXCIpO1xyXG5jb25zdCBmb3JtRWRpdEF2YXRhciA9IHBvcHVwRWRpdEF2YXRhci5xdWVyeVNlbGVjdG9yKFwiI2VkaXRBdmF0YXJcIik7XHJcblxyXG5jb25zdCBwb3B1cENhcmQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX3R5cGVfYWRkLWNhcmRcIik7XHJcbmNvbnN0IGZvcm1BZGRFbGVtZW50ID0gcG9wdXBDYXJkLnF1ZXJ5U2VsZWN0b3IoXCIjYWRkRm9ybVwiKTtcclxuY29uc3QgcG9wdXBBZGRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XHJcblxyXG5jb25zdCBidXR0b25FZGl0QXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hdmF0YXItZWRpdFwiKTtcclxuXHJcbmV4cG9ydCB7XHJcbiAgdmFsaWRhdGlvbkNvbmZpZyxcclxuICBjYXJkc0NvbnRhaW5lcixcclxuICBmb3JtRWRpdEVsZW1lbnQsXHJcbiAgcG9wdXBFZGl0QnV0dG9uLFxyXG4gIGluZm9UaXRsZSxcclxuICBpbmZvU3VidGl0bGUsXHJcbiAgZm9ybUFkZEVsZW1lbnQsXHJcbiAgcG9wdXBBZGRCdXR0b24sXHJcbiAgcG9wdXBOYW1lLFxyXG4gIHBvcHVwSm9iLFxyXG4gIGJ1dHRvbkVkaXRBdmF0YXIsXHJcbiAgZm9ybUVkaXRBdmF0YXIsXHJcbn07XHJcbiIsImltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcclxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xyXG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XHJcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xyXG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoQWNrIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEFjay5qc1wiO1xyXG5pbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xyXG5pbXBvcnQge1xyXG4gIHZhbGlkYXRpb25Db25maWcsXHJcbiAgZm9ybUVkaXRFbGVtZW50LFxyXG4gIGNhcmRzQ29udGFpbmVyLFxyXG4gIHBvcHVwRWRpdEJ1dHRvbixcclxuICBmb3JtQWRkRWxlbWVudCxcclxuICBwb3B1cEFkZEJ1dHRvbixcclxuICBwb3B1cE5hbWUsXHJcbiAgcG9wdXBKb2IsXHJcbiAgYnV0dG9uRWRpdEF2YXRhcixcclxuICBmb3JtRWRpdEF2YXRhcixcclxufSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XHJcblxyXG5sZXQgY2FyZHNCYXNrZXQ7XHJcblxyXG5jb25zdCBhcGkgPSBuZXcgQXBpKFxyXG4gIFwiaHR0cHM6Ly9tZXN0by5ub21vcmVwYXJ0aWVzLmNvL3YxL2NvaG9ydC02MVwiLFxyXG4gIFwiMzg4NmE3OTktNDg1NC00YTNjLThhODYtNGNmYTQxMmU3ZDU2XCJcclxuKTtcclxuXHJcbmNvbnN0IHBvcHVwV2l0aEltYWdlID0gbmV3IFBvcHVwV2l0aEltYWdlKFwiLnBvcHVwX3R5cGVfaW1nXCIpO1xyXG5wb3B1cFdpdGhJbWFnZS5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuY29uc3QgcG9wdXBFZGl0Rm9ybSA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gIFwiLnBvcHVwX3R5cGVfZWRpdC1wcm9maWxlXCIsXHJcbiAgc3VibWl0UHJvZmlsZUZvcm1cclxuKTtcclxucG9wdXBFZGl0Rm9ybS5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxucG9wdXBFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgY29uc3QgeyB1c2VyLCBhYm91dCB9ID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcclxuICBwb3B1cE5hbWUudmFsdWUgPSB1c2VyO1xyXG4gIHBvcHVwSm9iLnZhbHVlID0gYWJvdXQ7XHJcbiAgZm9ybVByb2ZpbGVWYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgcG9wdXBFZGl0Rm9ybS5vcGVuKCk7XHJcbn0pO1xyXG5cclxuZnVuY3Rpb24gc3VibWl0UHJvZmlsZUZvcm0oaW5wdXRWYWx1ZXMpIHtcclxuICBjb25zdCB7IF9pZCwgYXZhdGFyIH0gPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xyXG4gIHBvcHVwRWRpdEZvcm0ucmVuYW1lQnV0dG9uKCk7XHJcbiAgYXBpXHJcbiAgICAuc2V0RWRpdFVzZXJJbmZvKGlucHV0VmFsdWVzKVxyXG4gICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICB1c2VySW5mby5zZXRVc2VySW5mbyhpbnB1dFZhbHVlcy5uYW1lLCBpbnB1dFZhbHVlcy5qb2IsIF9pZCwgYXZhdGFyKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgfSlcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgcG9wdXBFZGl0Rm9ybS5jbG9zZSgpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmNvbnN0IHBvcHVwQWRkRm9ybSA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiLnBvcHVwX3R5cGVfYWRkLWNhcmRcIiwgc3VibWl0Q2FyZEZvcm0pO1xyXG5wb3B1cEFkZEZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmZ1bmN0aW9uIHN1Ym1pdENhcmRGb3JtKGlucHV0VmFsdWVzKSB7XHJcbiAgY29uc3QgbmFtZSA9IGlucHV0VmFsdWVzLnBpY3R1cmVUaXRsZTtcclxuICBjb25zdCBsaW5rID0gaW5wdXRWYWx1ZXMucGljdHVyZUxpbms7XHJcbiAgcG9wdXBBZGRGb3JtLnJlbmFtZUJ1dHRvbigpO1xyXG5cclxuICBhcGlcclxuICAgIC5jcmVhdGVDYXJkKHsgbmFtZSwgbGluayB9KVxyXG4gICAgLnRoZW4oKG5ld0l0ZW0pID0+IHtcclxuICAgICAgY29uc3QgbmV3Q2FyZCA9IGNyZWF0ZUNhcmQobmV3SXRlbSk7XHJcbiAgICAgIGNhcmRzQmFza2V0LmFkZEl0ZW0obmV3Q2FyZCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgIH0pXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIHBvcHVwQWRkRm9ybS5jbG9zZSgpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbnBvcHVwQWRkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgZW5hYmxlVmFsaWRhdGlvbkFkZC5yZXNldFZhbGlkYXRpb24oKTtcclxuICBwb3B1cEFkZEZvcm0ub3BlbigpO1xyXG59KTtcclxuXHJcbmZ1bmN0aW9uIGNyZWF0ZUNhcmQoaXRlbSkge1xyXG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcclxuICAgIGl0ZW0sXHJcbiAgICB1c2VySW5mby5nZXRVc2VySW5mbygpLFxyXG4gICAgXCIjZWxlbWVudC10ZW1wbGF0ZVwiLFxyXG4gICAgaGFuZGxlQ2FyZENsaWNrLFxyXG4gICAgZGVsZXRlQ2FyZCxcclxuICAgIGxpa2VDYXJkLFxyXG4gICAgZGlzbGlrZUNhcmRcclxuICApLmdldFRlbXBsYXRlQ2FyZCgpO1xyXG4gIHJldHVybiBjYXJkO1xyXG59XHJcblxyXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyh7XHJcbiAgbmFtZTogXCIuaW5mb19fdGl0bGVcIixcclxuICBhYm91dDogXCIuaW5mb19fc3VidGl0bGVcIixcclxuICBhdmF0YXI6IFwiLnByb2ZpbGVfX2F2YXRhclwiLFxyXG59KTtcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUNhcmRDbGljayhuYW1lLCBsaW5rKSB7XHJcbiAgcG9wdXBXaXRoSW1hZ2Uub3BlbihuYW1lLCBsaW5rKTtcclxufVxyXG5cclxuY29uc3QgZW5hYmxlVmFsaWRhdGlvbkVkaXQgPSBuZXcgRm9ybVZhbGlkYXRvcihcclxuICBmb3JtRWRpdEVsZW1lbnQsXHJcbiAgdmFsaWRhdGlvbkNvbmZpZ1xyXG4pO1xyXG5lbmFibGVWYWxpZGF0aW9uRWRpdC5lbmFibGVWYWxpZGF0aW9uKGZvcm1FZGl0RWxlbWVudCk7XHJcblxyXG5jb25zdCBlbmFibGVWYWxpZGF0aW9uQWRkID0gbmV3IEZvcm1WYWxpZGF0b3IoZm9ybUFkZEVsZW1lbnQsIHZhbGlkYXRpb25Db25maWcpO1xyXG5lbmFibGVWYWxpZGF0aW9uQWRkLmVuYWJsZVZhbGlkYXRpb24oZm9ybUFkZEVsZW1lbnQpO1xyXG5cclxuY29uc3QgZm9ybVByb2ZpbGVWYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcclxuICBmb3JtRWRpdEVsZW1lbnQsXHJcbiAgdmFsaWRhdGlvbkNvbmZpZ1xyXG4pO1xyXG5mb3JtUHJvZmlsZVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcblxyXG5hcGlcclxuICAuZ2V0Q2FyZHMoKVxyXG4gIC50aGVuKChpdGVtc0FwaSkgPT4ge1xyXG4gICAgY29uc29sZS5sb2coaXRlbXNBcGkpO1xyXG4gICAgY2FyZHNCYXNrZXQgPSBuZXcgU2VjdGlvbihcclxuICAgICAge1xyXG4gICAgICAgIGl0ZW1zOiBpdGVtc0FwaS5yZXZlcnNlKCksXHJcbiAgICAgICAgcmVuZGVyZXI6IGNyZWF0ZUNhcmQsXHJcbiAgICAgIH0sXHJcbiAgICAgIGNhcmRzQ29udGFpbmVyXHJcbiAgICApO1xyXG4gICAgY2FyZHNCYXNrZXQucmVuZGVySXRlbXMoKTtcclxuICB9KVxyXG4gIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gIH0pO1xyXG5cclxuYXBpXHJcbiAgLmdldFVzZXJJbmZvKClcclxuICAudGhlbigodXNlckluZm9BcGkpID0+IHtcclxuICAgIGNvbnNvbGUubG9nKHVzZXJJbmZvQXBpKTtcclxuICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKFxyXG4gICAgICB1c2VySW5mb0FwaS5uYW1lLFxyXG4gICAgICB1c2VySW5mb0FwaS5hYm91dCxcclxuICAgICAgdXNlckluZm9BcGkuX2lkLFxyXG4gICAgICB1c2VySW5mb0FwaS5hdmF0YXJcclxuICAgICk7XHJcbiAgICB1c2VySW5mby5zZXRVc2VyQXZhdGFyKHVzZXJJbmZvQXBpLmF2YXRhcik7XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgY29uc29sZS5sb2coZXJyKTtcclxuICB9KTtcclxuXHJcbmNvbnN0IHBvcHVwRGVsZXRlQ2FyZCA9IG5ldyBQb3B1cFdpdGhBY2soXCIucG9wdXBfdHlwZV9kZWxcIik7XHJcbnBvcHVwRGVsZXRlQ2FyZC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuZnVuY3Rpb24gZGVsZXRlQ2FyZChjYXJkLCBfaWQpIHtcclxuICBwb3B1cERlbGV0ZUNhcmQub3BlbigoKSA9PiB7XHJcbiAgICBhcGlcclxuICAgICAgLmRlbGV0ZUNhcmRBcGkoX2lkKVxyXG4gICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgY2FyZC5kZWxldGVDYXJkRWxlbWVudCgpO1xyXG4gICAgICAgIHBvcHVwRGVsZXRlQ2FyZC5jbG9zZSgpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICAgIH0pO1xyXG4gIH0pO1xyXG59XHJcblxyXG5jb25zdCBmb3JtQXZhdGFyVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoZm9ybUVkaXRBdmF0YXIsIHZhbGlkYXRpb25Db25maWcpO1xyXG5mb3JtQXZhdGFyVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuXHJcbmNvbnN0IHBvcHVwRWRpdEF2YXRhckZvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICBcIi5wb3B1cF90eXBlX2VkaXQtYXZhdGFyXCIsXHJcbiAgc3VibWl0QXZhdGFyRm9ybVxyXG4pO1xyXG5wb3B1cEVkaXRBdmF0YXJGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5idXR0b25FZGl0QXZhdGFyLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgZm9ybUF2YXRhclZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcclxuICBwb3B1cEVkaXRBdmF0YXJGb3JtLm9wZW4oKTtcclxufSk7XHJcblxyXG5mdW5jdGlvbiBzdWJtaXRBdmF0YXJGb3JtKGlucHV0VmFsdWVzKSB7XHJcbiAgcG9wdXBFZGl0QXZhdGFyRm9ybS5yZW5hbWVCdXR0b24oKTtcclxuICBhcGlcclxuICAgIC5zZXRFZGl0QXZhdGFyKGlucHV0VmFsdWVzKVxyXG4gICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICB1c2VySW5mby5zZXRVc2VyQXZhdGFyKGlucHV0VmFsdWVzLmF2YXRhcik7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgIH0pXHJcblxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBwb3B1cEVkaXRBdmF0YXJGb3JtLmNsb3NlKCk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gbGlrZUNhcmQoY2FyZCwgX2lkKSB7XHJcbiAgYXBpXHJcbiAgICAuYWRkTGlrZShfaWQpXHJcbiAgICAudGhlbigoY2FyZERhdGEpID0+IHtcclxuICAgICAgY2FyZC5saWtlRWxlbWVudChjYXJkRGF0YSk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBkaXNsaWtlQ2FyZChjYXJkLCBfaWQpIHtcclxuICBhcGlcclxuICAgIC5kZWxldGVMaWtlKF9pZClcclxuICAgIC50aGVuKChjYXJkRGF0YSkgPT4ge1xyXG4gICAgICBjYXJkLmRpc2xpa2VFbGVtZW50KGNhcmREYXRhKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgfSk7XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cCkge1xyXG4gICAgc3VwZXIocG9wdXApO1xyXG4gICAgdGhpcy5fcG9wdXBJbWFnZUltZyA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2ltZ1wiKTtcclxuICAgIHRoaXMuX3BvcHVwSW1hZ2VUaXRsZSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2ltZy10aXRsZVwiKTtcclxuICB9XHJcblxyXG4gIG9wZW4obmFtZSwgbGluaykge1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gICAgdGhpcy5fcG9wdXBJbWFnZUltZy5zcmMgPSBsaW5rO1xyXG4gICAgdGhpcy5fcG9wdXBJbWFnZUltZy5hbHQgPSBuYW1lO1xyXG4gICAgdGhpcy5fcG9wdXBJbWFnZVRpdGxlLnRleHRDb250ZW50ID0gbmFtZTtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgc3VwZXIuY2xvc2UoKTtcclxuICAgIHRoaXMuX3BvcHVwSW1hZ2VJbWcuc3JjID0gXCJcIjtcclxuICAgIHRoaXMuX3BvcHVwSW1hZ2VJbWcuYWx0ID0gXCJcIjtcclxuICAgIHRoaXMuX3BvcHVwSW1hZ2VUaXRsZS50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcclxuICBjb25zdHJ1Y3Rvcih7IG5hbWUsIGFib3V0LCBhdmF0YXIgfSkge1xyXG4gICAgdGhpcy5fbmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZSk7XHJcbiAgICB0aGlzLl9hYm91dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYWJvdXQpO1xyXG4gICAgdGhpcy5fYXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhdmF0YXIpO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICB1c2VyOiB0aGlzLl9uYW1lLnRleHRDb250ZW50LFxyXG4gICAgICBhYm91dDogdGhpcy5fYWJvdXQudGV4dENvbnRlbnQsXHJcbiAgICAgIF9pZDogdGhpcy5faWQsXHJcbiAgICAgIGF2YXRhcjogdGhpcy5fYXZhdGFyLnNyYyxcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBzZXRVc2VySW5mbyhuYW1lLCBhYm91dCwgX2lkLCBhdmF0YXIpIHtcclxuICAgIHRoaXMuX25hbWUudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgdGhpcy5fYWJvdXQudGV4dENvbnRlbnQgPSBhYm91dDtcclxuICAgIHRoaXMuX2lkID0gX2lkO1xyXG4gICAgdGhpcy5fYXZhdGFyLnNyYyA9IGF2YXRhcjtcclxuICB9XHJcblxyXG4gIHNldFVzZXJBdmF0YXIoYXZhdGFyKSB7XHJcbiAgICB0aGlzLl9hdmF0YXIuc3JjID0gYXZhdGFyO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEFjayBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3RvcihzZWxlY3Rvcikge1xyXG4gICAgc3VwZXIoc2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fYnV0dG9uID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fYnV0dG9uLXN1Ym1pdFwiKTtcclxuICB9XHJcbiAgb3BlbihoYW5kbGVTdWJtaXQpIHtcclxuICAgIHN1cGVyLm9wZW4oKTtcclxuICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCA9IGhhbmRsZVN1Ym1pdDtcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHRoaXMuX2J1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdGhpcy5faGFuZGxlU3VibWl0KCk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbImNvbnN0cnVjdG9yIiwiaXRlbSIsInVzZXIiLCJ0ZW1wbGF0ZSIsImhhbmRsZUNhcmRDbGljayIsImRlbGV0ZUNhcmQiLCJsaWtlQ2FyZCIsImRpc2xpa2VDYXJkIiwidGhpcyIsIl9uYW1lIiwibmFtZSIsIl9saW5rIiwibGluayIsIl91c2VySWQiLCJfaWQiLCJfb3duZXJJZCIsIm93bmVyIiwiX2NhcmRJZCIsIl90ZW1wbGF0ZSIsIl9oYW5kbGVDYXJkQ2xpY2siLCJfZGVsZXRlQ2FyZCIsIl9saWtlQ2FyZCIsIl9kaXNsaWtlQ2FyZCIsIl9saWtlUXVhbnRpdHkiLCJsaWtlcyIsImdldFRlbXBsYXRlQ2FyZCIsIl9jYXJkIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29udGVudCIsImNsb25lTm9kZSIsIl9saWtlIiwiX2xpa2VRdWFudGl0eUNhcmQiLCJfdGl0bGUiLCJfaW1hZ2UiLCJfZGVsZXRlIiwiX2ZpbGxDYXJkIiwiX3NldEV2ZW50SGFuZGxlcnMiLCJfYWRkTGlrZUNhcmQiLCJsaWtlRWxlbWVudCIsImNhcmREYXRhIiwidGV4dENvbnRlbnQiLCJsZW5ndGgiLCJjbGFzc0xpc3QiLCJhZGQiLCJfcmVtb3ZlTGlrZUNhcmQiLCJkaXNsaWtlRWxlbWVudCIsInJlbW92ZSIsIl9pc0xpa2UiLCJmaW5kIiwiZWxlbWVudElkIiwiX2lzWW91ckNhcmQiLCJfbGlrZUNhcmRGb3JVc2VyIiwiZGVsZXRlQ2FyZEVsZW1lbnQiLCJjbG9zZXN0IiwiYWRkRXZlbnRMaXN0ZW5lciIsInNyYyIsImFsdCIsImZvcm1FbGVtZW50IiwiY29uZmlnIiwiX2Zvcm1FbGVtZW50IiwiX2NvbmZpZyIsInJlc2V0VmFsaWRhdGlvbiIsIl90b2dnbGVCdXR0b25TdGF0ZSIsIl9pbnB1dExpc3QiLCJmb3JFYWNoIiwiaW5wdXRFbGVtZW50IiwiX2hpZGVJbnB1dEVycm9yIiwiX3Nob3dJbnB1dEVycm9yIiwiZXJyb3JFbGVtZW50IiwiaWQiLCJlcnJvckNsYXNzIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJpbnB1dEVycm9yQ2xhc3MiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oYXNJbnZhbGlkSW5wdXQiLCJzb21lIiwiX2J1dHRvbkVsZW1lbnQiLCJhY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJkaXNhYmxlZCIsIl9zZXRFdmVudExpc3RlbmVycyIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJpbnB1dFNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJlbmFibGVWYWxpZGF0aW9uIiwiU2VjdGlvbiIsIml0ZW1zIiwicmVuZGVyZXIiLCJzZWxlY3RvciIsIl9pbml0aWFsQXJyYXkiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwicmVuZGVySXRlbXMiLCJyZW5kZXJDYXJkIiwiYWRkSXRlbSIsImVsZW1lbnQiLCJwcmVwZW5kIiwiUG9wdXAiLCJwb3B1cCIsIl9wb3B1cCIsIl9oYW5kbGVFc2NDbG9zZSIsImJpbmQiLCJvcGVuIiwiY2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZXZ0IiwiY29kZSIsInNldEV2ZW50TGlzdGVuZXJzIiwiY3VycmVudFRhcmdldCIsInRhcmdldCIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9mb3JtIiwiX2J1dHRvblN1Ym1pdCIsIl9nZXRJbnB1dFZhbHVlcyIsIl9mb3JtVmFsdWVzIiwiaW5wdXQiLCJ2YWx1ZSIsInJlbmFtZUJ1dHRvbiIsInJlc2V0IiwicHJldmVudERlZmF1bHQiLCJ2YWxpZGF0aW9uQ29uZmlnIiwiZm9ybVNlbGVjdG9yIiwicG9wdXBQcm9maWxlIiwiZm9ybUVkaXRFbGVtZW50IiwicG9wdXBFZGl0QnV0dG9uIiwicG9wdXBOYW1lIiwicG9wdXBKb2IiLCJmb3JtRWRpdEF2YXRhciIsImZvcm1BZGRFbGVtZW50IiwicG9wdXBBZGRCdXR0b24iLCJidXR0b25FZGl0QXZhdGFyIiwiY2FyZHNCYXNrZXQiLCJhcGkiLCJiYXNlUGF0aCIsInRva2VuIiwiX2Jhc2VQYXRoIiwiX3Rva2VuIiwiX2dldEhlYWRlcnMiLCJhdXRob3JpemF0aW9uIiwiX2dldEpzb24iLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZ2V0VXNlckluZm8iLCJmZXRjaCIsImhlYWRlcnMiLCJ0aGVuIiwiZ2V0Q2FyZHMiLCJjcmVhdGVDYXJkIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJzZXRFZGl0VXNlckluZm8iLCJkYXRhIiwiYWJvdXQiLCJqb2IiLCJkZWxldGVDYXJkQXBpIiwiY2FyZElkIiwic2V0RWRpdEF2YXRhciIsImF2YXRhciIsImFkZExpa2UiLCJkZWxldGVMaWtlIiwicG9wdXBXaXRoSW1hZ2UiLCJfcG9wdXBJbWFnZUltZyIsIl9wb3B1cEltYWdlVGl0bGUiLCJwb3B1cEVkaXRGb3JtIiwiaW5wdXRWYWx1ZXMiLCJ1c2VySW5mbyIsInNldFVzZXJJbmZvIiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwibG9nIiwiZmluYWxseSIsImZvcm1Qcm9maWxlVmFsaWRhdG9yIiwicG9wdXBBZGRGb3JtIiwicGljdHVyZVRpdGxlIiwicGljdHVyZUxpbmsiLCJuZXdJdGVtIiwibmV3Q2FyZCIsIkNhcmQiLCJlbmFibGVWYWxpZGF0aW9uQWRkIiwiX2Fib3V0IiwiX2F2YXRhciIsInNldFVzZXJBdmF0YXIiLCJGb3JtVmFsaWRhdG9yIiwiaXRlbXNBcGkiLCJyZXZlcnNlIiwidXNlckluZm9BcGkiLCJwb3B1cERlbGV0ZUNhcmQiLCJfYnV0dG9uIiwiaGFuZGxlU3VibWl0IiwiX2hhbmRsZVN1Ym1pdCIsImNhcmQiLCJmb3JtQXZhdGFyVmFsaWRhdG9yIiwicG9wdXBFZGl0QXZhdGFyRm9ybSJdLCJzb3VyY2VSb290IjoiIn0=